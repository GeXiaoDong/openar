!function(t,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var e=r();for(var a in e)("object"==typeof exports?exports:t)[a]=e[a]}}(this,function(){return function(t){function r(a){if(e[a])return e[a].exports;var f=e[a]={i:a,l:!1,exports:{}};return t[a].call(f.exports,f,f.exports,r),f.l=!0,f.exports}var e={};return r.m=t,r.c=e,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:a})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},r.p="",r(r.s=0)}([function(t,r,e){"use strict";(function(t){function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(r,"__esModule",{value:!0});var f=a(e(2)),o=a(e(9));t.ARView=f.default,t.ARDebugger=o.default,r.default={ARView:f.default,ARDebugger:o.default}}).call(r,e(1))},function(t,r){var e;e=function(){return this}();try{e=e||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,r){for(var e=0;e<r.length;e++){var a=r[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(r,e,a){return e&&t(r.prototype,e),a&&t(r,a),r}}(),f=e(3),o=function(){function t(r,e){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.renderer=r,this.renderer.autoClear=!1,this.sceneCamera=e,this.prevFrame=null,this.scene=new THREE.Scene,this.camera=new THREE.OrthographicCamera(-1,1,1,-1),this.camera.position.z=1,this.init()}return a(t,[{key:"init",value:function(){var t=this;this.video=document.createElement("video"),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then(function(r){t.video.src=window.URL.createObjectURL(r)}),this.videoTexture=new THREE.VideoTexture(this.video),this.videoTexture.minFilter=THREE.LinearFilter,this.videoTexture.magFilter=THREE.LinearFilter;var r=new THREE.SpriteMaterial({map:this.videoTexture});this.screen=new THREE.Sprite(r),this.screen.scale.set(2,2),this.scene.add(this.screen)}},{key:"update",value:function(){this.renderer.clear(),this.renderer.render(this.scene,this.camera),this.renderer.clearDepth(),this.processFrame()}},{key:"processFrame",value:function(){var t=renderer.context,r=new Uint8Array(t.drawingBufferWidth*t.drawingBufferHeight*4);t.readPixels(0,0,t.drawingBufferWidth,t.drawingBufferHeight,t.RGBA,t.UNSIGNED_BYTE,r),null!==this.prevFrame&&(this.pose=(0,f.motionEstimation)(this.prevFrame,r,t.drawingBufferWidth,t.drawingBufferHeight),this.sceneCamera.rotation.x+=pose.rotation.x,this.sceneCamera.rotation.y+=pose.rotation.y,this.sceneCamera.rotation.z+=pose.rotation.z,this.sceneCamera.translation.x+=pose.translation.x,this.sceneCamera.translation.y+=pose.translation.y,this.sceneCamera.translation.z+=pose.translation.z),this.prevFrame=r}}]),t}();r.default=o},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.motionEstimation=void 0;var a=function(t){return t&&t.__esModule?t:{default:t}}(e(4));r.motionEstimation=a.default},function(t,r,e){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function f(t,r,e){var a=new n.default.pyramid_t(3);return a.allocate(r,e,n.default.U8_t|n.default.C1_t),n.default.imgproc.grayscale(t,r,e,a.data[0],n.default.COLOR_RGBA2GRAY),a.build(a.data[0],!1),a}function o(t){var r=new n.default.matrix_t(3,3,n.default.F32_t|n.default.C1_t),e=new n.default.matrix_t(3,3,n.default.F32_t|n.default.C1_t),a=new n.default.matrix_t(3,3,n.default.F32_t|n.default.C1_t),f=new n.default.matrix_t(3,3,n.default.F32_t|n.default.C1_t);f.data[1]=-1,f.data[3]=1,f.data[8]=1;var o=new n.default.matrix_t(3,3,n.default.F32_t|n.default.C1_t);n.default.linalg.svd_invert(o,f);var i=new n.default.matrix_t(3,3,n.default.F32_t|n.default.C1_t),s=new n.default.matrix_t(3,3,n.default.F32_t|n.default.C1_t);return n.default.linalg.svd_decompose(t,r,e,a),n.default.matmath.multiply_3x3(i,e,o),n.default.matmath.multiply_3x3(i,i,a),n.default.matmath.multiply_3x3(s,e,f),n.default.matmath.multiply_3x3(s,s,r),n.default.matmath.multiply_ABt(s,s,e),{rotation:function(t){return{x:Math.atan2(t[7],t[8]),y:Math.atan2(-t[6],Math.sqrt(Math.pow(t[7],2)+Math.pow(t[8],2))),z:Math.atan2(t[3],t[0])}}(i.data),translation:function(t){return{x:t[2],y:t[5],z:t[8]}}(s.data)}}function i(t,r,e,a){var i=f(t,e,a),u=f(r,e,a),c=[],h=[],d=function(t,r,e,a){for(var f=[],o=0;o<e*a;o++)f[o]=new n.default.keypoint_t;for(var i=n.default.fast_corners.detect(t.data[0],f,3),s=0;s<i;s++)r.push(f[s].x),r.push(f[s].y);return i}(i,c,e,a);n.default.optical_flow_lk.track(i,u,c,h,d,15,30,[],.01,1e-4);var l=new n.default.matrix_t(3,3,n.default.F32_t|n.default.C1_t),v=(0,s.default)(c,h);return l.data=v[0].concat(v[1].concat(v[2])),o(l)}Object.defineProperty(r,"__esModule",{value:!0});var n=a(e(5)),s=a(e(6));n.default.fast_corners.set_threshold(20),r.default=i},function(t,r){var e=e||{REVISION:"ALPHA"};!function(t){"use strict";var r=256,a=512,f=1024,o=new Int32Array([-1,1,4,-1,4,-1,-1,-1,8,-1,-1,-1,-1,-1,-1,-1,8]),i=function(t){return 65280&t},n=function(t){return 255&t},s=function(t){return o[(65280&t)>>8]},u=function(){return function(t,r){this.size=-8&(t+7|0),void 0===r?this.buffer=new ArrayBuffer(this.size):(this.buffer=r,this.size=r.length),this.u8=new Uint8Array(this.buffer),this.i32=new Int32Array(this.buffer),this.f32=new Float32Array(this.buffer),this.f64=new Float64Array(this.buffer)}}(),c=function(){function t(t,e,o,s){this.type=0|i(o),this.channel=0|n(o),this.cols=0|t,this.rows=0|e,void 0===s?this.allocate():(this.buffer=s,this.data=this.type&r?this.buffer.u8:this.type&a?this.buffer.i32:this.type&f?this.buffer.f32:this.buffer.f64)}return t.prototype.allocate=function(){delete this.data,delete this.buffer,this.buffer=new u(this.cols*s(this.type)*this.channel*this.rows),this.data=this.type&r?this.buffer.u8:this.type&a?this.buffer.i32:this.type&f?this.buffer.f32:this.buffer.f64},t.prototype.copy_to=function(t){for(var r=t.data,e=this.data,a=0,f=this.cols*this.rows*this.channel|0;a<f-4;a+=4)r[a]=e[a],r[a+1]=e[a+1],r[a+2]=e[a+2],r[a+3]=e[a+3];for(;a<f;++a)r[a]=e[a]},t.prototype.resize=function(t,r,e){void 0===e&&(e=this.channel);t*s(this.type)*e*r>this.buffer.size?(this.cols=t,this.rows=r,this.channel=e,this.allocate()):(this.cols=t,this.rows=r,this.channel=e)},t}(),h=function(){function t(t){this.levels=0|t,this.data=new Array(t),this.pyrdown=e.imgproc.pyrdown}return t.prototype.allocate=function(t,r,e){for(var a=this.levels;--a>=0;)this.data[a]=new c(t>>a,r>>a,e)},t.prototype.build=function(t,r){void 0===r&&(r=!0);var e=2,a=t,f=this.data[0];if(!r)for(var o=t.cols*t.rows;--o>=0;)f.data[o]=t.data[o];for(f=this.data[1],this.pyrdown(a,f);e<this.levels;++e)a=f,f=this.data[e],this.pyrdown(a,f)},t}(),d=function(){return function(t,r,e,a,f){void 0===t&&(t=0),void 0===r&&(r=0),void 0===e&&(e=0),void 0===a&&(a=0),void 0===f&&(f=-1),this.x=t,this.y=r,this.score=e,this.level=a,this.angle=f}}();t.U8_t=r,t.S32_t=a,t.F32_t=f,t.S64_t=2048,t.F64_t=4096,t.C1_t=1,t.C2_t=2,t.C3_t=3,t.C4_t=4,t.U8C1_t=1|r,t.U8C3_t=3|r,t.U8C4_t=4|r,t.F32C1_t=1|f,t.F32C2_t=2|f,t.S32C1_t=1|a,t.S32C2_t=2|a,t.EPSILON=1.192092896e-7,t.FLT_MIN=1e-37,t.COLOR_RGBA2GRAY=0,t.COLOR_RGB2GRAY=1,t.COLOR_BGRA2GRAY=2,t.COLOR_BGR2GRAY=3,t.BOX_BLUR_NOSCALE=1,t.SVD_U_T=1,t.SVD_V_T=2,t.get_data_type=i,t.get_channel=n,t.get_data_type_size=s,t.data_t=u,t.matrix_t=c,t.pyramid_t=h,t.keypoint_t=d}(e),function(t){"use strict";var r=function(){var t,r,a=function(){function t(t){this.next=null,this.data=new e.data_t(t),this.size=this.data.size,this.buffer=this.data.buffer,this.u8=this.data.u8,this.i32=this.data.i32,this.f32=this.data.f32,this.f64=this.data.f64}return t.prototype.resize=function(t){delete this.data,this.data=new e.data_t(t),this.size=this.data.size,this.buffer=this.data.buffer,this.u8=this.data.u8,this.i32=this.data.i32,this.f32=this.data.f32,this.f64=this.data.f64},t}(),f=0;return{allocate:function(e,o){t=r=new a(o);for(var i=0;i<e;++i){var n=new a(o);r=r.next=n,f++}},get_buffer:function(r){var e=t;return t=t.next,f--,r>e.size&&e.resize(r),e},put_buffer:function(t){r=r.next=t,f++}}}();t.cache=r,r.allocate(30,2560)}(e),function(t){"use strict";var r=function(){var t=new Int32Array(96);return{get_gaussian_kernel:function(t,r,a,f){var o=0,i=0,n=0,s=0,u=0,c=0,h=e.cache.get_buffer(t<<2),d=h.f32;if(1==(1&t)&&t<=7&&r<=0)switch(t>>1){case 0:d[0]=1,c=1;break;case 1:d[0]=.25,d[1]=.5,d[2]=.25,c=1;break;case 2:d[0]=.0625,d[1]=.25,d[2]=.375,d[3]=.25,d[4]=.0625,c=1;break;case 3:d[0]=.03125,d[1]=.109375,d[2]=.21875,d[3]=.28125,d[4]=.21875,d[5]=.109375,d[6]=.03125,c=1}else for(u=-.5/((s=r>0?r:.3*(.5*(t-1)-1)+.8)*s);o<t;++o)i=o-.5*(t-1),n=Math.exp(u*i*i),d[o]=n,c+=n;if(f&e.U8_t)for(c=256/c,o=0;o<t;++o)a[o]=d[o]*c+.5|0;else for(c=1/c,o=0;o<t;++o)a[o]=d[o]*c;e.cache.put_buffer(h)},perspective_4point_transform:function(t,r,e,a,f,o,i,n,s,u,c,h,d,l,v,_,p){var b=r,m=u,y=i,x=b*m*y,w=v,g=b*w,M=m*g,k=c,z=b*k,C=o,A=e,R=l,O=A*R,E=O*C,L=R*C*k,S=R*y,F=R*k,T=m*y,U=w*m,B=w*C,V=k*C,q=1/(S-F-T+U-B+V),I=b*R,P=A*C,G=y*b,W=w*G,j=A*m,H=O*k,N=A*k*C,D=y*w*m,Y=w*A,X=-(M-x+z*C-C*g-O*m+E-L+S*m)*q,Q=(x-M-I*y+I*k+E-m*P+B*m-L)*q,Z=b,J=(-k*g+W+j*y-O*y+H-N+B*k-D)*q,K=(G*k-W-Y*m+H-N+Y*C+D-S*k)*q,$=A,tt=(-z+G+j-P+F-S-U+B)*q,rt=(-g+z+O-j+B-V-S+T)*q,et=-((M=(m=h)*(g=(b=a)*(w=p)))-(x=b*m*(y=s))+(z=b*(k=d))*(C=n)-C*g-(O=(A=f)*(R=_))*m+(E=O*C)-(L=R*C*k)+(S=R*y)*m)*(q=1/(S-(F=R*k)-(T=m*y)+(U=w*m)-(B=w*C)+(V=k*C))),at=(x-M-(I=b*R)*y+I*k+E-m*(P=A*C)+B*m-L)*q,ft=b,ot=(-k*g+(W=w*(G=y*b))+(j=A*m)*y-O*y+(H=O*k)-(N=A*k*C)+B*k-(D=y*w*m))*q,it=(G*k-W-(Y=w*A)*m+H-N+Y*C+D-S*k)*q,nt=A,st=(-z+G+j-P+F-S-U+B)*q,ut=(-g+z+O-j+B-V-S+T)*q,ct=Z*tt;E=$*tt-J;var ht=-J*rt+K*tt,dt=X-ct;P=X*rt-(z=Q*tt);var lt=(x=X*$)-(M=Z*J),vt=(y=X*K)-(g=J*Q);N=(m=K-rt*$)*(R=1/(y-x*rt-g+M*rt+z*$-ct*K));var _t=(V=Z*rt-Q)*R,pt=(G=-Q*$+Z*K)*R,bt=t.data;bt[0]=et*N+at*(E*R)-ft*(ht*R),bt[1]=et*_t+at*(dt*R)-ft*(P*R),bt[2]=-et*pt-at*(lt*R)+ft*(vt*R),bt[3]=ot*N+it*(E*R)-nt*(ht*R),bt[4]=ot*_t+it*(dt*R)-nt*(P*R),bt[5]=-ot*pt-it*(lt*R)+nt*(vt*R),bt[6]=st*N+ut*(E*R)-ht*R,bt[7]=st*_t+ut*(dt*R)-P*R,bt[8]=-st*pt-ut*(lt*R)+vt*R},qsort:function(r,e,a,f){var o,i,n,s,u=0,c=0,h=0,d=0,l=0,v=0,_=0,p=0,b=0,m=0,y=0,x=0,w=0,g=0,M=0,k=0,z=0,C=0,A=t;if(!(a-e+1<=1))for(A[0]=e,A[1]=a;u>=0;)for(c=A[u<<1],h=A[1+(u<<1)],u--;;){if((l=h-c+1)<=7){for(_=c+1;_<=h;_++)for(p=_;p>c&&f(r[p],r[p-1]);p--)o=r[p],r[p]=r[p-1],r[p-1]=o;break}for(C=0,m=c,x=h,g=c+(l>>1),l>40&&(k=c+(b=l>>3),z=c+(b<<1),i=r[M=c],n=r[k],s=r[z],c=f(i,n)?f(n,s)?k:f(i,s)?z:M:f(s,n)?k:f(i,s)?M:z,k=g,z=g+b,i=r[M=g-b],n=r[k],s=r[z],g=f(i,n)?f(n,s)?k:f(i,s)?z:M:f(s,n)?k:f(i,s)?M:z,k=h-b,z=h,i=r[M=h-(b<<1)],n=r[k],s=r[z],h=f(i,n)?f(n,s)?k:f(i,s)?z:M:f(s,n)?k:f(i,s)?M:z),k=g,z=h,i=r[M=c],n=r[k],s=r[z],(g=f(i,n)?f(n,s)?k:f(i,s)?z:M:f(s,n)?k:f(i,s)?M:z)!=m&&(o=r[g],r[g]=r[m],r[m]=o,g=m),c=y=m+1,h=w=x,i=r[g];;){for(;c<=h&&!f(i,r[c]);)f(r[c],i)||(c>y&&(o=r[y],r[y]=r[c],r[c]=o),C=1,y++),c++;for(;c<=h&&!f(r[h],i);)f(i,r[h])||(h<w&&(o=r[w],r[w]=r[h],r[h]=o),C=1,w--),h--;if(c>h)break;o=r[c],r[c]=r[h],r[h]=o,C=1,c++,h--}if(0==C){for(h=x,_=(c=m)+1;_<=h;_++)for(p=_;p>c&&f(r[p],r[p-1]);p--)o=r[p],r[p]=r[p-1],r[p-1]=o;break}for(v=c-(l=Math.min(y-m,c-y))|0,d=0;d<l;++d,++v)o=r[m+d],r[m+d]=r[v],r[v]=o;for(v=x-(l=Math.min(x-w,w-h))+1|0,d=0;d<l;++d,++v)o=r[c+d],r[c+d]=r[v],r[v]=o;if(l=c-y,v=w-h,l>1)v>1?l>v?(A[++u<<1]=m,A[1+(u<<1)]=m+l-1,c=x-v+1,h=x):(A[++u<<1]=x-v+1,A[1+(u<<1)]=x,c=m,h=m+l-1):(c=m,h=m+l-1);else{if(!(v>1))break;c=x-v+1,h=x}}},median:function(t,r,e){for(var a,f=0,o=0,i=0,n=r+e>>1;;){if(e<=r)return t[n];if(e==r+1)return t[r]>t[e]&&(a=t[r],t[r]=t[e],t[e]=a),t[n];for(t[f=r+e>>1]>t[e]&&(a=t[f],t[f]=t[e],t[e]=a),t[r]>t[e]&&(a=t[r],t[r]=t[e],t[e]=a),t[f]>t[r]&&(a=t[f],t[f]=t[r],t[r]=a),o=r+1,a=t[f],t[f]=t[o],t[o]=a,i=e;;){do{++o}while(t[r]>t[o]);do{--i}while(t[i]>t[r]);if(i<o)break;a=t[o],t[o]=t[i],t[i]=a}a=t[r],t[r]=t[i],t[i]=a,i<=n?r=o:i>=n&&(e=i-1)}return 0}}}();t.math=r}(e),function(t){"use strict";var r={identity:function(t,r){void 0===r&&(r=1);for(var e=t.data,a=t.rows,f=t.cols,o=f+1|0,i=a*f,n=i;--i>=0;)e[i]=0;for(i=n,n=0;n<i;)e[n]=r,n+=o},transpose:function(t,r){for(var e=0,a=0,f=r.rows,o=r.cols,i=0,n=0,s=0,u=r.data,c=t.data;e<f;n+=1,i+=o,e++)for(s=n,a=0;a<o;s+=f,a++)c[s]=u[i+a]},multiply:function(t,r,e){for(var a=0,f=0,o=0,i=0,n=0,s=0,u=0,c=0,h=r.cols,d=r.rows,l=e.cols,v=r.data,_=e.data,p=t.data,b=0;a<d;i+=h,a++)for(u=0,f=0;f<l;c++,u++,f++){for(s=u,n=i,b=0,o=0;o<h;n++,s+=l,o++)b+=v[n]*_[s];p[c]=b}},multiply_ABt:function(t,r,e){for(var a=0,f=0,o=0,i=0,n=0,s=0,u=0,c=r.cols,h=r.rows,d=e.rows,l=r.data,v=e.data,_=t.data,p=0;a<h;i+=c,a++)for(s=0,f=0;f<d;u++,f++){for(n=i,p=0,o=0;o<c;n++,s++,o++)p+=l[n]*v[s];_[u]=p}},multiply_AtB:function(t,r,e){for(var a=0,f=0,o=0,i=0,n=0,s=0,u=0,c=0,h=r.cols,d=r.rows,l=e.cols,v=r.data,_=e.data,p=t.data,b=0;a<h;i++,a++)for(u=0,f=0;f<l;c++,u++,f++){for(s=u,n=i,b=0,o=0;o<d;n+=h,s+=l,o++)b+=v[n]*_[s];p[c]=b}},multiply_AAt:function(t,r){for(var e=0,a=0,f=0,o=0,i=0,n=0,s=0,u=0,c=0,h=r.cols,d=r.rows,l=r.data,v=t.data,_=0;e<d;o+=d+1,i=n,e++)for(u=o,c=o,s=i,a=e;a<d;u++,c+=d,a++){for(n=i,_=0,f=0;f<h;f++)_+=l[n++]*l[s++];v[u]=_,v[c]=_}},multiply_AtA:function(t,r){for(var e=0,a=0,f=0,o=0,i=0,n=0,s=0,u=0,c=0,h=r.cols,d=r.rows,l=r.data,v=t.data,_=0;e<h;s+=h,e++)for(o=e,u=c=s+e,a=e;a<h;u++,c+=h,a++){for(i=o,n=a,_=0,f=0;f<d;i+=h,n+=h,f++)_+=l[i]*l[n];v[u]=_,v[c]=_}},identity_3x3:function(t,r){void 0===r&&(r=1);var e=t.data;e[0]=e[4]=e[8]=r,e[1]=e[2]=e[3]=0,e[5]=e[6]=e[7]=0},invert_3x3:function(t,r){var e=t.data,a=r.data,f=e[4],o=e[8],i=e[5],n=e[7],s=e[0],u=s*f,c=s*i,h=e[3],d=e[1],l=h*d,v=e[2],_=h*v,p=e[6],b=p*d,m=p*v,y=1/(u*o-c*n-l*o+_*n+b*i-m*f);a[0]=(f*o-i*n)*y,a[1]=-(d*o-v*n)*y,a[2]=-(-d*i+v*f)*y,a[3]=-(h*o-i*p)*y,a[4]=(s*o-m)*y,a[5]=-(c-_)*y,a[6]=-(-h*n+f*p)*y,a[7]=-(s*n-b)*y,a[8]=(u-l)*y},multiply_3x3:function(t,r,e){var a=t.data,f=r.data,o=e.data,i=f[0],n=f[1],s=f[2],u=f[3],c=f[4],h=f[5],d=f[6],l=f[7],v=f[8],_=o[0],p=o[1],b=o[2],m=o[3],y=o[4],x=o[5],w=o[6],g=o[7],M=o[8];a[0]=i*_+n*m+s*w,a[1]=i*p+n*y+s*g,a[2]=i*b+n*x+s*M,a[3]=u*_+c*m+h*w,a[4]=u*p+c*y+h*g,a[5]=u*b+c*x+h*M,a[6]=d*_+l*m+v*w,a[7]=d*p+l*y+v*g,a[8]=d*b+l*x+v*M},mat3x3_determinant:function(t){var r=t.data;return r[0]*r[4]*r[8]-r[0]*r[5]*r[7]-r[3]*r[1]*r[8]+r[3]*r[2]*r[7]+r[6]*r[1]*r[5]-r[6]*r[2]*r[4]},determinant_3x3:function(t,r,e,a,f,o,i,n,s){return t*f*s-t*o*n-a*r*s+a*e*n+i*r*o-i*e*f}};e.matmath=r}(),function(t){"use strict";var r=function(){var t=function(t,r,e,a){a=t[r],t[r]=t[e],t[e]=a},r=function(t,r){return t=Math.abs(t),r=Math.abs(r),t>r?(r/=t,t*Math.sqrt(1+r*r)):r>0?(t/=r,r*Math.sqrt(1+t*t)):0};return{lu_solve:function(r,a){var f,o,i,n,s=0,u=0,c=0,h=1,d=r.cols,l=r.data,v=a.data;for(s=0;s<d;s++){for(c=s,u=s+1;u<d;u++)Math.abs(l[u*d+s])>Math.abs(l[c*d+s])&&(c=u);if(Math.abs(l[c*d+s])<e.EPSILON)return 0;if(c!=s){for(u=s;u<d;u++)t(l,s*d+u,c*d+u,f);t(v,s,c,f),h=-h}for(i=-1/l[s*d+s],u=s+1;u<d;u++){for(o=l[u*d+s]*i,c=s+1;c<d;c++)l[u*d+c]+=o*l[s*d+c];v[u]+=o*v[s]}l[s*d+s]=-i}for(s=d-1;s>=0;s--){for(n=v[s],c=s+1;c<d;c++)n-=l[s*d+c]*v[c];v[s]=n*l[s*d+s]}return 1},cholesky_solve:function(t,r){var e,a,f=0,o=0,i=0,n=0,s=0,u=0,c=0,h=t.cols,d=t.data,l=r.data;for(f=0;f<h;f++)for(a=1,s=n=f*h,o=f;o<h;o++){for(e=d[s+f],i=0;i<f;i++)e-=d[i*h+f]*d[s+i];if(o==f){if(d[s+f]=e,0==e)return 0;a=1/e}else d[n+o]=e,d[s+f]=e*a;s+=h}for(n=0,u=0;u<h;u++){for(e=l[u],c=0;c<u;c++)e-=d[n+c]*l[c];l[u]=e,n+=h}for(n=0,u=0;u<h;u++)l[u]/=d[n+u],n+=h;for(u=h-1;u>=0;u--){for(e=l[u],n=(c=u+1)*h;c<h;c++)e-=d[n+u]*l[c],n+=h;l[u]=e}return 1},svd_decompose:function(a,f,o,i,n){void 0===n&&(n=0);var s=0,u=0,c=a.rows,h=a.cols,d=c,l=h,v=a.type|e.C1_t;d<l&&(s=1,u=d,d=l,l=u);var _=e.cache.get_buffer(d*d<<3),p=e.cache.get_buffer(l<<3),b=e.cache.get_buffer(l*l<<3),m=new e.matrix_t(d,d,v,_.data),y=new e.matrix_t(1,l,v,p.data),x=new e.matrix_t(l,l,v,b.data);if(0==s)e.matmath.transpose(m,a);else{for(u=0;u<h*c;u++)m.data[u]=a.data[u];for(;u<l*d;u++)m.data[u]=0}if(function(a,f,o,i,n,s,u,c){for(var h=2*e.EPSILON,d=e.FLT_MIN,l=0,v=0,_=0,p=0,b=Math.max(s,30),m=0,y=0,x=0,w=0,g=0,M=0,k=0,z=0,C=0,A=0,R=0,O=0,E=0,L=0,S=0,F=0,T=0,U=4660,B=0,V=0,q=0,I=e.cache.get_buffer(u<<3),P=I.f64;l<u;l++){for(_=0,R=0;_<s;_++)R+=(z=a[l*f+_])*z;if(P[l]=R,i){for(_=0;_<u;_++)i[l*n+_]=0;i[l*n+l]=1}}for(;p<b;p++){for(g=0,l=0;l<u-1;l++)for(v=l+1;v<u;v++){for(m=l*f|0,y=v*f|0,S=P[l],F=0,T=P[v],_=2,F+=a[m]*a[y],F+=a[m+1]*a[y+1];_<s;_++)F+=a[m+_]*a[y+_];if(!(Math.abs(F)<=h*Math.sqrt(S*T))){for(E=r(F*=2,O=S-T),O<0?(L=.5*(E-O),M=F/(E*(k=Math.sqrt(L/E))*2)):k=F/(E*(M=Math.sqrt((E+O)/(2*E)))*2),S=0,T=0,_=2,C=M*a[m]+k*a[y],A=-k*a[m]+M*a[y],a[m]=C,a[y]=A,S+=C*C,T+=A*A,C=M*a[m+1]+k*a[y+1],A=-k*a[m+1]+M*a[y+1],a[m+1]=C,a[y+1]=A,S+=C*C,T+=A*A;_<s;_++)C=M*a[m+_]+k*a[y+_],A=-k*a[m+_]+M*a[y+_],a[m+_]=C,a[y+_]=A,S+=C*C,T+=A*A;if(P[l]=S,P[v]=T,g=1,i)for(w=v*n|0,_=2,C=M*i[x=l*n|0]+k*i[w],A=-k*i[x]+M*i[w],i[x]=C,i[w]=A,C=M*i[x+1]+k*i[w+1],A=-k*i[x+1]+M*i[w+1],i[x+1]=C,i[w+1]=A;_<u;_++)C=M*i[x+_]+k*i[w+_],A=-k*i[x+_]+M*i[w+_],i[x+_]=C,i[w+_]=A}}if(0==g)break}for(l=0;l<u;l++){for(_=0,R=0;_<s;_++)R+=(z=a[l*f+_])*z;P[l]=Math.sqrt(R)}for(l=0;l<u-1;l++){for(v=l,_=l+1;_<u;_++)P[v]<P[_]&&(v=_);if(l!=v&&(t(P,l,v,R),i)){for(_=0;_<s;_++)t(a,l*f+_,v*f+_,z);for(_=0;_<u;_++)t(i,l*n+_,v*n+_,z)}}for(l=0;l<u;l++)o[l]=P[l];if(i){for(l=0;l<c;l++){for(R=l<u?P[l]:0;R<=d;){for(V=1/s,_=0;_<s;_++)B=0!=(256&(U=214013*U+2531011)>>16)?V:-V,a[l*f+_]=B;for(p=0;p<2;p++)for(v=0;v<l;v++){for(R=0,_=0;_<s;_++)R+=a[l*f+_]*a[v*f+_];for(q=0,_=0;_<s;_++)z=a[l*f+_]-R*a[v*f+_],a[l*f+_]=z,q+=Math.abs(z);for(q=q?1/q:0,_=0;_<s;_++)a[l*f+_]*=q}for(R=0,_=0;_<s;_++)R+=(z=a[l*f+_])*z;R=Math.sqrt(R)}for(k=1/R,_=0;_<s;_++)a[l*f+_]*=k}e.cache.put_buffer(I)}else e.cache.put_buffer(I)}(m.data,d,y.data,x.data,l,d,l,d),f){for(u=0;u<l;u++)f.data[u]=y.data[u];for(;u<h;u++)f.data[u]=0}if(0==s){if(o&&n&e.SVD_U_T)for(u=d*d;--u>=0;)o.data[u]=m.data[u];else o&&e.matmath.transpose(o,m);if(i&&n&e.SVD_V_T)for(u=l*l;--u>=0;)i.data[u]=x.data[u];else i&&e.matmath.transpose(i,x)}else{if(o&&n&e.SVD_U_T)for(u=l*l;--u>=0;)o.data[u]=x.data[u];else o&&e.matmath.transpose(o,x);if(i&&n&e.SVD_V_T)for(u=d*d;--u>=0;)i.data[u]=m.data[u];else i&&e.matmath.transpose(i,m)}e.cache.put_buffer(_),e.cache.put_buffer(p),e.cache.put_buffer(b)},svd_solve:function(t,r,a){var f=0,o=0,i=0,n=0,s=0,u=t.rows,c=t.cols,h=0,d=0,l=0,v=t.type|e.C1_t,_=e.cache.get_buffer(u*u<<3),p=e.cache.get_buffer(c<<3),b=e.cache.get_buffer(c*c<<3),m=new e.matrix_t(u,u,v,_.data),y=new e.matrix_t(1,c,v,p.data),x=new e.matrix_t(c,c,v,b.data),w=a.data,g=m.data,M=y.data,k=x.data;for(this.svd_decompose(t,y,m,x,0),l=e.EPSILON*M[0]*c;f<c;f++,s+=c){for(d=0,o=0;o<c;o++)if(M[o]>l){for(i=0,h=0,n=0;i<u;i++,n+=c)h+=g[n+o]*w[i];d+=h*k[s+o]/M[o]}r.data[f]=d}e.cache.put_buffer(_),e.cache.put_buffer(p),e.cache.put_buffer(b)},svd_invert:function(t,r){var a=0,f=0,o=0,i=0,n=0,s=0,u=r.rows,c=r.cols,h=0,d=0,l=r.type|e.C1_t,v=e.cache.get_buffer(u*u<<3),_=e.cache.get_buffer(c<<3),p=e.cache.get_buffer(c*c<<3),b=new e.matrix_t(u,u,l,v.data),m=new e.matrix_t(1,c,l,_.data),y=new e.matrix_t(c,c,l,p.data),x=t.data,w=b.data,g=m.data,M=y.data;for(this.svd_decompose(r,m,b,y,0),d=e.EPSILON*g[0]*c;a<c;a++,n+=c)for(f=0,i=0;f<u;f++,s++){for(o=0,h=0;o<c;o++,i++)g[o]>d&&(h+=M[n+o]*w[i]/g[o]);x[s]=h}e.cache.put_buffer(v),e.cache.put_buffer(_),e.cache.put_buffer(p)},eigenVV:function(a,f,o){for(var i=a.cols,n=i*i,s=a.type|e.C1_t,u=e.cache.get_buffer(i*i<<3),c=e.cache.get_buffer(i<<3),h=new e.matrix_t(i,i,s,u.data),d=new e.matrix_t(1,i,s,c.data);--n>=0;)h.data[n]=a.data[n];if(function(a,f,o,i,n,s){var u=e.EPSILON,c=0,h=0,d=0,l=0,v=0,_=0,p=0,b=0,m=0,y=s*s*30,x=0,w=0,g=0,M=0,k=0,z=0,C=0,A=0,R=0,O=e.cache.get_buffer(s<<2),E=e.cache.get_buffer(s<<2),L=O.i32,S=E.i32;if(i)for(;c<s;c++){for(d=c*n,h=0;h<s;h++)i[d+h]=0;i[d+c]=1}for(d=0;d<s;d++){if(o[d]=a[(f+1)*d],d<s-1){for(l=d+1,x=Math.abs(a[f*d+l]),c=d+2;c<s;c++)x<(w=Math.abs(a[f*d+c]))&&(x=w,l=c);L[d]=l}if(d>0){for(l=0,x=Math.abs(a[d]),c=1;c<d;c++)x<(w=Math.abs(a[f*c+d]))&&(x=w,l=c);S[d]=l}}if(s>1)for(;m<y;m++){for(d=0,x=Math.abs(a[L[0]]),c=1;c<s-1;c++)x<(w=Math.abs(a[f*c+L[c]]))&&(x=w,d=c);for(v=L[d],c=1;c<s;c++)x<(w=Math.abs(a[f*S[c]+c]))&&(x=w,d=S[c],v=c);if(g=a[f*d+v],Math.abs(g)<=u)break;for(M=.5*(o[v]-o[d]),C=(k=Math.abs(M)+r(g,M))/(z=r(g,k)),z=g/z,k=g/k*g,M<0&&(z=-z,k=-k),a[f*d+v]=0,o[d]-=k,o[v]+=k,c=0;c<d;c++)b=f*c+v,A=a[p=f*c+d],R=a[b],a[p]=A*C-R*z,a[b]=A*z+R*C;for(c=d+1;c<v;c++)b=f*c+v,A=a[p=f*d+c],R=a[b],a[p]=A*C-R*z,a[b]=A*z+R*C;for(p=f*d+(c=v+1),b=f*v+c;c<s;c++,p++,b++)A=a[p],R=a[b],a[p]=A*C-R*z,a[b]=A*z+R*C;if(i)for(p=n*d,b=n*v,c=0;c<s;c++,p++,b++)A=i[p],R=i[b],i[p]=A*C-R*z,i[b]=A*z+R*C;for(h=0;h<2;h++){if((_=0==h?d:v)<s-1){for(l=_+1,x=Math.abs(a[f*_+l]),c=_+2;c<s;c++)x<(w=Math.abs(a[f*_+c]))&&(x=w,l=c);L[_]=l}if(_>0){for(l=0,x=Math.abs(a[_]),c=1;c<_;c++)x<(w=Math.abs(a[f*c+_]))&&(x=w,l=c);S[_]=l}}}for(d=0;d<s-1;d++){for(l=d,c=d+1;c<s;c++)o[l]<o[c]&&(l=c);if(d!=l&&(t(o,l,d,x),i))for(c=0;c<s;c++)t(i,n*l+c,n*d+c,x)}e.cache.put_buffer(O),e.cache.put_buffer(E)}(h.data,i,d.data,f?f.data:null,i,i),o)for(;--i>=0;)o.data[i]=d.data[i];e.cache.put_buffer(u),e.cache.put_buffer(c)}}}();t.linalg=r}(e),function(t){"use strict";var r=function(){var t=function(t){return t*t},r=new e.matrix_t(3,3,e.F32_t|e.C1_t),a=new e.matrix_t(3,3,e.F32_t|e.C1_t),f=new e.matrix_t(6,6,e.F32_t|e.C1_t),o=new e.matrix_t(6,1,e.F32_t|e.C1_t),i=function(){function i(){}return i.prototype.run=function(t,i,n,s){var u,c,h=0,d=0,l=n.type|e.C1_t,v=n.data,_=r.data,p=a.data,b=0,m=0;!function(t,r,e,a,f){for(var o=0,i=0,n=0,s=0,u=0,c=0,h=0,d=0,l=0,v=0,_=0;o<f;++o)i+=t[o].x,n+=t[o].y,c+=r[o].x,h+=r[o].y;for(i/=f,n/=f,c/=f,h/=f,o=0;o<f;++o)v=t[o].x-i,_=t[o].y-n,s+=Math.sqrt(v*v+_*_),v=r[o].x-c,_=r[o].y-h,d+=Math.sqrt(v*v+_*_);s/=f,d/=f,u=Math.SQRT2/s,l=Math.SQRT2/d,e[0]=e[4]=u,e[2]=-i*u,e[5]=-n*u,e[1]=e[3]=e[6]=e[7]=0,e[8]=1,a[0]=a[4]=l,a[2]=-c*l,a[5]=-h*l,a[1]=a[3]=a[6]=a[7]=0,a[8]=1}(t,i,_,p,s);for(var y=e.cache.get_buffer(2*s*6<<3),x=e.cache.get_buffer(2*s<<3),w=new e.matrix_t(6,2*s,l,y.data),g=new e.matrix_t(1,2*s,l,x.data),M=w.data,k=g.data;h<s;++h)u=t[h],c=i[h],b=_[0]*u.x+_[1]*u.y+_[2],m=_[3]*u.x+_[4]*u.y+_[5],M[d=2*h*6]=b,M[d+1]=m,M[d+2]=1,M[d+3]=0,M[d+4]=0,M[d+5]=0,M[d+=6]=0,M[d+1]=0,M[d+2]=0,M[d+3]=b,M[d+4]=m,M[d+5]=1,k[h<<1]=p[0]*c.x+p[1]*c.y+p[2],k[1+(h<<1)]=p[3]*c.x+p[4]*c.y+p[5];return e.matmath.multiply_AtA(f,w),e.matmath.multiply_AtB(o,w,g),e.linalg.lu_solve(f,o),v[0]=o.data[0],v[1]=o.data[1],v[2]=o.data[2],v[3]=o.data[3],v[4]=o.data[4],v[5]=o.data[5],v[6]=0,v[7]=0,v[8]=1,e.matmath.invert_3x3(a,a),e.matmath.multiply_3x3(n,a,n),e.matmath.multiply_3x3(n,n,r),e.cache.put_buffer(y),e.cache.put_buffer(x),1},i.prototype.error=function(r,e,a,f,o){for(var i,n,s=0,u=a.data;s<o;++s)i=r[s],n=e[s],f[s]=t(n.x-u[0]*i.x-u[1]*i.y-u[2])+t(n.y-u[3]*i.x-u[4]*i.y-u[5])},i.prototype.check_subset=function(t,r,e){return!0},i}(),n=new e.matrix_t(9,9,e.F32_t|e.C1_t),s=new e.matrix_t(9,9,e.F32_t|e.C1_t);return{affine2d:i,homography2d:function(){function t(){}return t.prototype.run=function(t,f,o,i){for(var u=0,c=0,h=o.data,d=r.data,l=a.data,v=n.data,_=s.data,p=0,b=0,m=0,y=0,x=0,w=0,g=0,M=0,k=0,z=0,C=0,A=0;u<i;++u)g+=f[u].x,M+=f[u].y,C+=t[u].x,A+=t[u].y;for(g/=i,M/=i,C/=i,A/=i,u=0;u<i;++u)x+=Math.abs(f[u].x-g),w+=Math.abs(f[u].y-M),k+=Math.abs(t[u].x-C),z+=Math.abs(t[u].y-A);if(Math.abs(x)<e.EPSILON||Math.abs(w)<e.EPSILON||Math.abs(k)<e.EPSILON||Math.abs(z)<e.EPSILON)return 0;for(x=i/x,w=i/w,k=i/k,z=i/z,d[0]=k,d[1]=0,d[2]=-C*k,d[3]=0,d[4]=z,d[5]=-A*z,d[6]=0,d[7]=0,d[8]=1,l[0]=1/x,l[1]=0,l[2]=g,l[3]=0,l[4]=1/w,l[5]=M,l[6]=0,l[7]=0,l[8]=1,u=81;--u>=0;)v[u]=0;for(u=0;u<i;++u)p=(f[u].x-g)*x,b=(f[u].y-M)*w,m=(t[u].x-C)*k,y=(t[u].y-A)*z,v[0]+=m*m,v[1]+=m*y,v[2]+=m,v[6]+=m*-p*m,v[7]+=m*-p*y,v[8]+=m*-p,v[10]+=y*y,v[11]+=y,v[15]+=y*-p*m,v[16]+=y*-p*y,v[17]+=y*-p,v[20]+=1,v[24]+=-p*m,v[25]+=-p*y,v[26]+=-p,v[30]+=m*m,v[31]+=m*y,v[32]+=m,v[33]+=m*-b*m,v[34]+=m*-b*y,v[35]+=m*-b,v[40]+=y*y,v[41]+=y,v[42]+=y*-b*m,v[43]+=y*-b*y,v[44]+=y*-b,v[50]+=1,v[51]+=-b*m,v[52]+=-b*y,v[53]+=-b,v[60]+=-p*m*-p*m+-b*m*-b*m,v[61]+=-p*m*-p*y+-b*m*-b*y,v[62]+=-p*m*-p+-b*m*-b,v[70]+=-p*y*-p*y+-b*y*-b*y,v[71]+=-p*y*-p+-b*y*-b,v[80]+=-p*-p+-b*-b;for(u=0;u<9;++u)for(c=0;c<u;++c)v[9*u+c]=v[9*c+u];return e.linalg.eigenVV(n,s),h[0]=_[72],h[1]=_[73],h[2]=_[74],h[3]=_[75],h[4]=_[76],h[5]=_[77],h[6]=_[78],h[7]=_[79],h[8]=_[80],e.matmath.multiply_3x3(o,a,o),e.matmath.multiply_3x3(o,o,r),p=1/h[8],h[0]*=p,h[1]*=p,h[2]*=p,h[3]*=p,h[4]*=p,h[5]*=p,h[6]*=p,h[7]*=p,h[8]=1,1},t.prototype.error=function(t,r,e,a,f){for(var o,i,n=0,s=0,u=0,c=0,h=e.data;n<f;++n)o=t[n],i=r[n],s=1/(h[6]*o.x+h[7]*o.y+1),u=(h[0]*o.x+h[1]*o.y+h[2])*s-i.x,c=(h[3]*o.x+h[4]*o.y+h[5])*s-i.y,a[n]=u*u+c*c},t.prototype.check_subset=function(t,r,a){if(4==a){var f=0,o=t[0],i=t[1],n=t[2],s=t[3],u=r[0],c=r[1],h=r[2],d=r[3],l=o.x,v=o.y,_=i.x,p=i.y,b=n.x,m=n.y,y=u.x,x=u.y,w=c.x,g=c.y,M=h.x,k=h.y,z=e.matmath.determinant_3x3(l,v,1,_,p,1,b,m,1),C=e.matmath.determinant_3x3(y,x,1,w,g,1,M,k,1);if(z*C<0&&f++,l=i.x,v=i.y,_=n.x,p=n.y,b=s.x,m=s.y,y=c.x,x=c.y,w=h.x,g=h.y,M=d.x,k=d.y,z=e.matmath.determinant_3x3(l,v,1,_,p,1,b,m,1),C=e.matmath.determinant_3x3(y,x,1,w,g,1,M,k,1),z*C<0&&f++,l=o.x,v=o.y,_=n.x,p=n.y,b=s.x,m=s.y,y=u.x,x=u.y,w=h.x,g=h.y,M=d.x,k=d.y,z=e.matmath.determinant_3x3(l,v,1,_,p,1,b,m,1),C=e.matmath.determinant_3x3(y,x,1,w,g,1,M,k,1),z*C<0&&f++,l=o.x,v=o.y,_=i.x,p=i.y,b=s.x,m=s.y,y=u.x,x=u.y,w=c.x,g=c.y,M=d.x,k=d.y,z=e.matmath.determinant_3x3(l,v,1,_,p,1,b,m,1),C=e.matmath.determinant_3x3(y,x,1,w,g,1,M,k,1),z*C<0&&f++,0!=f&&4!=f)return!1}return!0},t}()}}(),a=function(){function t(t,r,e,a){void 0===t&&(t=0),void 0===r&&(r=.5),void 0===e&&(e=.5),void 0===a&&(a=.99),this.size=t,this.thresh=r,this.eps=e,this.prob=a}return t.prototype.update_iters=function(t,r){var e=Math.log(1-this.prob),a=Math.log(1-Math.pow(1-t,this.size));return 0|(a>=0||-e>=r*-a?r:Math.round(e/a))},t}(),f=function(){var t=function(t,r,e,a,f,o,i){for(var n=[],s=0,u=0,c=0,h=0,d=!1;c<1e3;++c){for(s=0;s<a&&c<1e3;){for(d=!1,h=0;!d;)for(d=!0,h=n[s]=0|Math.floor(Math.random()*f),u=0;u<s;++u)if(h==n[u]){d=!1;break}o[s]=r[h],i[s]=e[h],t.check_subset(o,i,s+1)?++s:c++}break}return s==a&&c<1e3},r=function(t,r,e,a,f,o,i,n){var s=0,u=0,c=0,h=o*o;for(t.error(e,a,r,i,f);u<f;++u)c=i[u]<=h,n[u]=c,s+=c;return s};return{ransac:function(a,f,o,i,n,s,u,c){if(void 0===c&&(c=1e3),n<a.size)return!1;var h=a.size,d=c,l=0,v=!1,_=[],p=[],b=s.cols,m=s.rows,y=s.type|e.C1_t,x=e.cache.get_buffer(b*m<<3),w=e.cache.get_buffer(n),g=e.cache.get_buffer(n<<2),M=new e.matrix_t(b,m,y,x.data),k=new e.matrix_t(n,1,e.U8C1_t,w.data),z=-1,C=0,A=g.f32;if(n==h){if(f.run(o,i,M,n)<=0)return e.cache.put_buffer(x),e.cache.put_buffer(w),e.cache.put_buffer(g),!1;if(M.copy_to(s),u)for(;--n>=0;)u.data[n]=1;return e.cache.put_buffer(x),e.cache.put_buffer(w),e.cache.put_buffer(g),!0}for(;l<d;++l){if(!t(f,o,i,h,n,_,p)){if(0==l)return e.cache.put_buffer(x),e.cache.put_buffer(w),e.cache.put_buffer(g),!1;break}f.run(_,p,M,h)<=0||(C=r(f,M,o,i,n,a.thresh,A,k.data))>Math.max(z,h-1)&&(M.copy_to(s),z=C,u&&k.copy_to(u),d=a.update_iters((n-C)/n,d),v=!0)}return e.cache.put_buffer(x),e.cache.put_buffer(w),e.cache.put_buffer(g),v},lmeds:function(a,f,o,i,n,s,u,c){if(void 0===c&&(c=1e3),n<a.size)return!1;var h=a.size,d=c,l=0,v=!1,_=[],p=[],b=s.cols,m=s.rows,y=s.type|e.C1_t,x=e.cache.get_buffer(b*m<<3),w=e.cache.get_buffer(n),g=e.cache.get_buffer(n<<2),M=new e.matrix_t(b,m,y,x.data),k=new e.matrix_t(n,1,e.U8_t|e.C1_t,w.data),z=0,C=g.f32,A=1e9,R=0,O=0;if(a.eps=.45,d=a.update_iters(a.eps,d),n==h){if(f.run(o,i,M,n)<=0)return e.cache.put_buffer(x),e.cache.put_buffer(w),e.cache.put_buffer(g),!1;if(M.copy_to(s),u)for(;--n>=0;)u.data[n]=1;return e.cache.put_buffer(x),e.cache.put_buffer(w),e.cache.put_buffer(g),!0}for(;l<d;++l){if(!t(f,o,i,h,n,_,p)){if(0==l)return e.cache.put_buffer(x),e.cache.put_buffer(w),e.cache.put_buffer(g),!1;break}f.run(_,p,M,h)<=0||(f.error(o,i,M,C,n),(O=e.math.median(C,0,n-1))<A&&(A=O,M.copy_to(s),v=!0))}return v&&(R=2.5*1.4826*(1+5/(n-h))*Math.sqrt(A),R=Math.max(R,.001),z=r(f,s,o,i,n,R,C,k.data),u&&k.copy_to(u),v=z>=h),e.cache.put_buffer(x),e.cache.put_buffer(w),e.cache.put_buffer(g),v}}}();t.ransac_params_t=a,t.motion_model=r,t.motion_estimator=f}(e),function(t){"use strict";var r={grayscale:function(t,r,a,f,o){void 0===o&&(o=e.COLOR_RGBA2GRAY);var i=0,n=0,s=0,u=0,c=0,h=0,d=4899,l=1868,v=4;o!=e.COLOR_BGRA2GRAY&&o!=e.COLOR_BGR2GRAY||(d=1868,l=4899),o!=e.COLOR_RGB2GRAY&&o!=e.COLOR_BGR2GRAY||(v=3);var _=v<<1,p=3*v|0;f.resize(r,a,1);var b=f.data;for(n=0;n<a;++n,u+=r,s+=r*v){for(i=0,c=s,h=u;i<=r-4;i+=4,c+=v<<2,h+=4)b[h]=t[c]*d+9617*t[c+1]+t[c+2]*l+8192>>14,b[h+1]=t[c+v]*d+9617*t[c+v+1]+t[c+v+2]*l+8192>>14,b[h+2]=t[c+_]*d+9617*t[c+_+1]+t[c+_+2]*l+8192>>14,b[h+3]=t[c+p]*d+9617*t[c+p+1]+t[c+p+2]*l+8192>>14;for(;i<r;++i,++h,c+=v)b[h]=t[c]*d+9617*t[c+1]+t[c+2]*l+8192>>14}},resample:function(t,r,a,f){var o=t.rows,i=t.cols;o>f&&i>a&&(r.resize(a,f,t.channel),t.type&e.U8_t&&r.type&e.U8_t&&o*i/(f*a)<256?function(t,r,a,f){for(var o=0,i=t.channel,n=t.cols,s=t.rows,u=t.data,c=r.data,h=n/a,d=s/f,l=h*d*65536|0,v=0,_=0,p=0,b=0,m=0,y=0,x=0,w=0,g=0,M=0,k=0,z=0,C=0,A=0,R=0,O=0,E=e.cache.get_buffer(a*i<<2),L=e.cache.get_buffer(a*i<<2),S=e.cache.get_buffer(2*n*3<<2),F=E.i32,T=L.i32,U=S.i32;v<a;v++){for(m=1+(g=v*h)-1e-6|0,y=0|(M=g+h),m=Math.min(m,n-1),y=Math.min(y,n-1),m>g&&(U[w++]=v*i|0,U[w++]=(m-1)*i|0,U[w++]=256*(m-g)|0,o++),p=m;p<y;p++)o++,U[w++]=v*i|0,U[w++]=p*i|0,U[w++]=256;M-y>.001&&(o++,U[w++]=v*i|0,U[w++]=y*i|0,U[w++]=256*(M-y)|0)}for(v=0;v<a*i;v++)F[v]=T[v]=0;for(_=0,b=0;b<s;b++){for(k=n*b,w=0;w<o;w++)for(C=U[3*w],m=U[3*w+1],A=U[3*w+2],x=0;x<i;x++)F[C+x]+=u[k+m+x]*A;if((_+1)*d<=b+1||b==s-1){if(R=256*Math.max(b+1-(_+1)*d,0)|0,O=256-R,z=a*_,R<=0)for(v=0;v<a*i;v++)c[z+v]=Math.min(Math.max((T[v]+256*F[v])/l,0),255),T[v]=F[v]=0;else for(v=0;v<a*i;v++)c[z+v]=Math.min(Math.max((T[v]+F[v]*O)/l,0),255),T[v]=F[v]*R,F[v]=0;_++}else for(v=0;v<a*i;v++)T[v]+=256*F[v],F[v]=0}e.cache.put_buffer(L),e.cache.put_buffer(E),e.cache.put_buffer(S)}(t,r,a,f):function(t,r,a,f){for(var o=0,i=t.channel,n=t.cols,s=t.rows,u=t.data,c=r.data,h=n/a,d=s/f,l=1/(h*d),v=0,_=0,p=0,b=0,m=0,y=0,x=0,w=0,g=0,M=0,k=0,z=0,C=0,A=0,R=0,O=0,E=e.cache.get_buffer(a*i<<2),L=e.cache.get_buffer(a*i<<2),S=e.cache.get_buffer(2*n*3<<2),F=E.f32,T=L.f32,U=S.f32;v<a;v++){for(m=1+(g=v*h)-1e-6|0,y=0|(M=g+h),m=Math.min(m,n-1),y=Math.min(y,n-1),m>g&&(o++,U[w++]=(m-1)*i|0,U[w++]=v*i|0,U[w++]=(m-g)*l),p=m;p<y;p++)o++,U[w++]=p*i|0,U[w++]=v*i|0,U[w++]=l;M-y>.001&&(o++,U[w++]=y*i|0,U[w++]=v*i|0,U[w++]=(M-y)*l)}for(v=0;v<a*i;v++)F[v]=T[v]=0;for(_=0,b=0;b<s;b++){for(k=n*b,w=0;w<o;w++)for(m=0|U[3*w],C=0|U[3*w+1],A=U[3*w+2],x=0;x<i;x++)F[C+x]+=u[k+m+x]*A;if((_+1)*d<=b+1||b==s-1){if(R=Math.max(b+1-(_+1)*d,0),O=1-R,z=a*_,Math.abs(R)<.001)for(v=0;v<a*i;v++)c[z+v]=T[v]+F[v],T[v]=F[v]=0;else for(v=0;v<a*i;v++)c[z+v]=T[v]+F[v]*O,T[v]=F[v]*R,F[v]=0;_++}else for(v=0;v<a*i;v++)T[v]+=F[v],F[v]=0}e.cache.put_buffer(L),e.cache.put_buffer(E),e.cache.put_buffer(S)}(t,r,a,f))},box_blur_gray:function(t,r,a,f){void 0===f&&(f=0);var o=t.cols,i=t.rows,n=i<<1,s=o<<1,u=0,c=0,h=0,d=0,l=1+(a<<1)|0,v=a+1|0,_=v+1|0,p=f&e.BOX_BLUR_NOSCALE?1:1/(l*l),b=e.cache.get_buffer(o*i<<2),m=0,y=0,x=0,w=0,g=0,M=b.i32,k=t.data,z=0;for(r.resize(o,i,t.channel),h=0;h<i;++h){for(y=h,m=v*k[x],u=x+1|0,d=x+a|0;u<=d;++u)m+=k[u];for(w=x+v|0,z=k[g=x],c=0;c<a;++c,y+=i)M[y]=m,m+=k[w]-z,w++;for(;c<o-_;c+=2,y+=n)M[y]=m,m+=k[w]-k[g],M[y+i]=m,m+=k[w+1]-k[g+1],w+=2,g+=2;for(;c<o-v;++c,y+=i)M[y]=m,m+=k[w]-k[g],w++,g++;for(z=k[w-1];c<o;++c,y+=i)M[y]=m,m+=z-k[g],g++;x+=o}if(x=0,k=r.data,1==p)for(h=0;h<o;++h){for(y=h,m=v*M[x],u=x+1|0,d=x+a|0;u<=d;++u)m+=M[u];for(w=x+v,z=M[g=x],c=0;c<a;++c,y+=o)k[y]=m,m+=M[w]-z,w++;for(;c<i-_;c+=2,y+=s)k[y]=m,m+=M[w]-M[g],k[y+o]=m,m+=M[w+1]-M[g+1],w+=2,g+=2;for(;c<i-v;++c,y+=o)k[y]=m,m+=M[w]-M[g],w++,g++;for(z=M[w-1];c<i;++c,y+=o)k[y]=m,m+=z-M[g],g++;x+=i}else for(h=0;h<o;++h){for(y=h,m=v*M[x],u=x+1|0,d=x+a|0;u<=d;++u)m+=M[u];for(w=x+v,z=M[g=x],c=0;c<a;++c,y+=o)k[y]=m*p,m+=M[w]-z,w++;for(;c<i-_;c+=2,y+=s)k[y]=m*p,m+=M[w]-M[g],k[y+o]=m*p,m+=M[w+1]-M[g+1],w+=2,g+=2;for(;c<i-v;++c,y+=o)k[y]=m*p,m+=M[w]-M[g],w++,g++;for(z=M[w-1];c<i;++c,y+=o)k[y]=m*p,m+=z-M[g],g++;x+=i}e.cache.put_buffer(b)},gaussian_blur:function(t,r,a,f){void 0===f&&(f=0),void 0===a&&(a=0);var o=(a=0==a?2*Math.max(1,4*f+1-1e-8)+1|0:a)>>1,i=t.cols,n=t.rows,s=t.type,u=s&e.U8_t;r.resize(i,n,t.channel);var c,h,d=t.data,l=r.data,v=a+Math.max(n,i)|0,_=e.cache.get_buffer(v<<2),p=e.cache.get_buffer(a<<2);u?(c=_.i32,h=p.i32):s&e.S32_t?(c=_.i32,h=p.f32):(c=_.f32,h=p.f32),e.math.get_gaussian_kernel(a,f,h,s),u?function(t,r,e,a,f,o,i,n){for(var s=0,u=0,c=0,h=0,d=0,l=0,v=0,_=0,p=0,b=o[0],m=0,y=a<<1,x=3*a,w=a<<2;s<f;++s){for(l=r[h],u=0;u<n;++u)t[u]=l;for(u=0;u<=a-2;u+=2)t[u+n]=r[h+u],t[u+n+1]=r[h+u+1];for(;u<a;++u)t[u+n]=r[h+u];for(l=r[h+a-1],u=a;u<n+a;++u)t[u+n]=l;for(u=0;u<=a-4;u+=4){for(l=t[u]*b,v=t[u+1]*b,_=t[u+2]*b,p=t[u+3]*b,c=1;c<i;++c)m=o[c],l+=t[c+u]*m,v+=t[c+u+1]*m,_+=t[c+u+2]*m,p+=t[c+u+3]*m;e[d+u]=Math.min(l>>8,255),e[d+u+1]=Math.min(v>>8,255),e[d+u+2]=Math.min(_>>8,255),e[d+u+3]=Math.min(p>>8,255)}for(;u<a;++u){for(l=t[u]*b,c=1;c<i;++c)l+=t[c+u]*o[c];e[d+u]=Math.min(l>>8,255)}h+=a,d+=a}for(s=0;s<a;++s){for(l=e[s],u=0;u<n;++u)t[u]=l;for(c=s,u=0;u<=f-2;u+=2,c+=y)t[u+n]=e[c],t[u+n+1]=e[c+a];for(;u<f;++u,c+=a)t[u+n]=e[c];for(l=e[(f-1)*a+s],u=f;u<n+f;++u)t[u+n]=l;for(d=s,u=0;u<=f-4;u+=4,d+=w){for(l=t[u]*b,v=t[u+1]*b,_=t[u+2]*b,p=t[u+3]*b,c=1;c<i;++c)m=o[c],l+=t[c+u]*m,v+=t[c+u+1]*m,_+=t[c+u+2]*m,p+=t[c+u+3]*m;e[d]=Math.min(l>>8,255),e[d+a]=Math.min(v>>8,255),e[d+y]=Math.min(_>>8,255),e[d+x]=Math.min(p>>8,255)}for(;u<f;++u,d+=a){for(l=t[u]*b,c=1;c<i;++c)l+=t[c+u]*o[c];e[d]=Math.min(l>>8,255)}}}(c,d,l,i,n,h,a,o):function(t,r,e,a,f,o,i,n){for(var s=0,u=0,c=0,h=0,d=0,l=0,v=0,_=0,p=0,b=o[0],m=0,y=a<<1,x=3*a,w=a<<2;s<f;++s){for(l=r[h],u=0;u<n;++u)t[u]=l;for(u=0;u<=a-2;u+=2)t[u+n]=r[h+u],t[u+n+1]=r[h+u+1];for(;u<a;++u)t[u+n]=r[h+u];for(l=r[h+a-1],u=a;u<n+a;++u)t[u+n]=l;for(u=0;u<=a-4;u+=4){for(l=t[u]*b,v=t[u+1]*b,_=t[u+2]*b,p=t[u+3]*b,c=1;c<i;++c)m=o[c],l+=t[c+u]*m,v+=t[c+u+1]*m,_+=t[c+u+2]*m,p+=t[c+u+3]*m;e[d+u]=l,e[d+u+1]=v,e[d+u+2]=_,e[d+u+3]=p}for(;u<a;++u){for(l=t[u]*b,c=1;c<i;++c)l+=t[c+u]*o[c];e[d+u]=l}h+=a,d+=a}for(s=0;s<a;++s){for(l=e[s],u=0;u<n;++u)t[u]=l;for(c=s,u=0;u<=f-2;u+=2,c+=y)t[u+n]=e[c],t[u+n+1]=e[c+a];for(;u<f;++u,c+=a)t[u+n]=e[c];for(l=e[(f-1)*a+s],u=f;u<n+f;++u)t[u+n]=l;for(d=s,u=0;u<=f-4;u+=4,d+=w){for(l=t[u]*b,v=t[u+1]*b,_=t[u+2]*b,p=t[u+3]*b,c=1;c<i;++c)m=o[c],l+=t[c+u]*m,v+=t[c+u+1]*m,_+=t[c+u+2]*m,p+=t[c+u+3]*m;e[d]=l,e[d+a]=v,e[d+y]=_,e[d+x]=p}for(;u<f;++u,d+=a){for(l=t[u]*b,c=1;c<i;++c)l+=t[c+u]*o[c];e[d]=l}}}(c,d,l,i,n,h,a,o),e.cache.put_buffer(_),e.cache.put_buffer(p)},pyrdown:function(t,r,e,a){void 0===e&&(e=0),void 0===a&&(a=0);var f=t.cols,o=f>>1,i=t.rows>>1,n=o-(e<<1),s=i-(a<<1),u=0,c=0,h=e+a*f,d=0,l=0,v=0;r.resize(o,i,t.channel);var _=t.data,p=r.data;for(c=0;c<s;++c){for(d=h,v=l,u=0;u<=n-2;u+=2,v+=2,d+=4)p[v]=_[d]+_[d+1]+_[d+f]+_[d+f+1]+2>>2,p[v+1]=_[d+2]+_[d+3]+_[d+f+2]+_[d+f+3]+2>>2;for(;u<n;++u,++v,d+=2)p[v]=_[d]+_[d+1]+_[d+f]+_[d+f+1]+2>>2;h+=f<<1,l+=o}},scharr_derivatives:function(t,r){var a,f,o,i,n,s,u,c,h=t.cols,d=t.rows,l=h<<1,v=0,_=0,p=0,b=0,m=0,y=0,x=0;r.resize(h,d,2);var w=t.data,g=r.data,M=e.cache.get_buffer(h+2<<2),k=e.cache.get_buffer(h+2<<2);for(t.type&e.U8_t||t.type&e.S32_t?(u=M.i32,c=k.i32):(u=M.f32,c=k.f32);_<d;++_,m+=h){for(b=(_>0?_-1:1)*h|0,y=(_<d-1?_+1:d-2)*h|0,x=_*l|0,v=0,p=1;v<=h-2;v+=2,p+=2)a=w[b+v],f=w[y+v],u[p]=3*(a+f)+10*w[m+v],c[p]=f-a,a=w[b+v+1],f=w[y+v+1],u[p+1]=3*(a+f)+10*w[m+v+1],c[p+1]=f-a;for(;v<h;++v,++p)a=w[b+v],f=w[y+v],u[p]=3*(a+f)+10*w[m+v],c[p]=f-a;for(v=h+1|0,u[0]=u[1],u[v]=u[h],c[0]=c[1],c[v]=c[h],v=0;v<=h-4;v+=4)a=c[v+2],f=c[v+1],o=c[v+3],i=c[v+4],n=u[v+2],s=u[v+3],g[x++]=n-u[v],g[x++]=3*(a+c[v])+10*f,g[x++]=s-u[v+1],g[x++]=3*(o+f)+10*a,g[x++]=u[v+4]-n,g[x++]=3*(i+a)+10*o,g[x++]=u[v+5]-s,g[x++]=3*(c[v+5]+o)+10*i;for(;v<h;++v)g[x++]=u[v+2]-u[v],g[x++]=3*(c[v+2]+c[v])+10*c[v+1]}e.cache.put_buffer(M),e.cache.put_buffer(k)},sobel_derivatives:function(t,r){var a,f,o,i,n,s,u,c,h=t.cols,d=t.rows,l=h<<1,v=0,_=0,p=0,b=0,m=0,y=0,x=0;r.resize(h,d,2);var w=t.data,g=r.data,M=e.cache.get_buffer(h+2<<2),k=e.cache.get_buffer(h+2<<2);for(t.type&e.U8_t||t.type&e.S32_t?(u=M.i32,c=k.i32):(u=M.f32,c=k.f32);_<d;++_,m+=h){for(b=(_>0?_-1:1)*h|0,y=(_<d-1?_+1:d-2)*h|0,x=_*l|0,v=0,p=1;v<=h-2;v+=2,p+=2)a=w[b+v],f=w[y+v],u[p]=a+f+2*w[m+v],c[p]=f-a,a=w[b+v+1],f=w[y+v+1],u[p+1]=a+f+2*w[m+v+1],c[p+1]=f-a;for(;v<h;++v,++p)a=w[b+v],f=w[y+v],u[p]=a+f+2*w[m+v],c[p]=f-a;for(v=h+1|0,u[0]=u[1],u[v]=u[h],c[0]=c[1],c[v]=c[h],v=0;v<=h-4;v+=4)a=c[v+2],f=c[v+1],o=c[v+3],i=c[v+4],n=u[v+2],s=u[v+3],g[x++]=n-u[v],g[x++]=a+c[v]+2*f,g[x++]=s-u[v+1],g[x++]=o+f+2*a,g[x++]=u[v+4]-n,g[x++]=i+a+2*o,g[x++]=u[v+5]-s,g[x++]=c[v+5]+o+2*i;for(;v<h;++v)g[x++]=u[v+2]-u[v],g[x++]=c[v+2]+c[v]+2*c[v+1]}e.cache.put_buffer(M),e.cache.put_buffer(k)},compute_integral_image:function(t,r,e,a){var f=0|t.cols,o=0|t.rows,i=t.data,n=f+1|0,s=0,u=0,c=0,h=0,d=0,l=0,v=0,_=0;if(r&&e){for(;d<n;++d)r[d]=0,e[d]=0;for(c=n+1|0,h=1,d=0,_=0;d<o;++d,++c,++h){for(s=u=0,l=0;l<=f-2;l+=2,_+=2,c+=2,h+=2)s+=v=i[_],u+=v*v,r[c]=r[h]+s,e[c]=e[h]+u,s+=v=i[_+1],u+=v*v,r[c+1]=r[h+1]+s,e[c+1]=e[h+1]+u;for(;l<f;++l,++_,++c,++h)s+=v=i[_],u+=v*v,r[c]=r[h]+s,e[c]=e[h]+u}}else if(r){for(;d<n;++d)r[d]=0;for(c=n+1|0,h=1,d=0,_=0;d<o;++d,++c,++h){for(s=0,l=0;l<=f-2;l+=2,_+=2,c+=2,h+=2)s+=i[_],r[c]=r[h]+s,s+=i[_+1],r[c+1]=r[h+1]+s;for(;l<f;++l,++_,++c,++h)s+=i[_],r[c]=r[h]+s}}else if(e){for(;d<n;++d)e[d]=0;for(c=n+1|0,h=1,d=0,_=0;d<o;++d,++c,++h){for(u=0,l=0;l<=f-2;l+=2,_+=2,c+=2,h+=2)u+=(v=i[_])*v,e[c]=e[h]+u,u+=(v=i[_+1])*v,e[c+1]=e[h+1]+u;for(;l<f;++l,++_,++c,++h)u+=(v=i[_])*v,e[c]=e[h]+u}}if(a){for(d=0;d<n;++d)a[d]=0;for(c=n+1|0,h=0,d=0,_=0;d<o;++d,++c,++h){for(l=0;l<=f-2;l+=2,_+=2,c+=2,h+=2)a[c]=i[_]+a[h],a[c+1]=i[_+1]+a[h+1];for(;l<f;++l,++_,++c,++h)a[c]=i[_]+a[h]}for(c=n+f|0,h=f,d=0;d<o;++d,c+=n,h+=n)a[c]+=a[h];for(l=f-1;l>0;--l)for(h=(c=l+o*n)-n,d=o;d>0;--d,c-=n,h-=n)a[c]+=a[h]+a[h+1]}},equalize_histogram:function(t,r){var a=t.cols,f=t.rows,o=t.data;r.resize(a,f,t.channel);var i,n,s=r.data,u=a*f,c=0,h=0,d=e.cache.get_buffer(1024);for(i=d.i32;c<256;++c)i[c]=0;for(c=0;c<u;++c)++i[o[c]];for(h=i[0],c=1;c<256;++c)h=i[c]+=h;for(n=255/u,c=0;c<u;++c)s[c]=i[o[c]]*n+.5|0;e.cache.put_buffer(d)},canny:function(t,r,a,f){var o=t.cols,i=t.rows;t.data;r.resize(o,i,t.channel);var n=r.data,s=0,u=0,c=0,h=o<<1,d=0,l=0,v=0,_=0,p=0,b=0,m=0,y=0,x=e.cache.get_buffer(i*h<<2),w=e.cache.get_buffer(3*(o+2)<<2),g=e.cache.get_buffer((i+2)*(o+2)<<2),M=e.cache.get_buffer(i*o<<2),k=w.i32,z=g.i32,C=M.i32,A=x.i32,R=new e.matrix_t(o,i,e.S32C2_t,x.data),O=1,E=o+2+1|0,L=2*(o+2)+1|0,S=o+2|0,F=S+1|0,T=0;for(this.sobel_derivatives(t,R),a>f&&(s=a,a=f,f=s),s=3*(o+2)|0;--s>=0;)k[s]=0;for(s=(i+2)*(o+2)|0;--s>=0;)z[s]=0;for(;u<o;++u,c+=2)_=A[c],p=A[c+1],k[E+u]=(_^_>>31)-(_>>31)+((p^p>>31)-(p>>31));for(s=1;s<=i;++s,c+=h){if(s==i)for(u=L+o;--u>=L;)k[u]=0;else for(u=0;u<o;u++)_=A[c+(u<<1)],p=A[c+(u<<1)+1],k[L+u]=(_^_>>31)-(_>>31)+((p^p>>31)-(p>>31));for(d=c-h|0,z[F-1]=0,l=0,u=0;u<o;++u,d+=2){if((v=k[E+u])>a)if(_=A[d],p=A[d+1],b=_^p,_=(_^_>>31)-(_>>31)|0,p=(p^p>>31)-(p>>31)|0,m=13573*_,y=m+(_+_<<15),(p<<=15)<m){if(v>k[E+u-1]&&v>=k[E+u+1]){v>f&&!l&&2!=z[F+u-S]?(z[F+u]=2,l=1,C[T++]=F+u):z[F+u]=1;continue}}else if(p>y){if(v>k[O+u]&&v>=k[L+u]){v>f&&!l&&2!=z[F+u-S]?(z[F+u]=2,l=1,C[T++]=F+u):z[F+u]=1;continue}}else if(b=b<0?-1:1,v>k[O+u-b]&&v>k[L+u+b]){v>f&&!l&&2!=z[F+u-S]?(z[F+u]=2,l=1,C[T++]=F+u):z[F+u]=1;continue}z[F+u]=0,l=0}z[F+o]=0,F+=S,u=O,O=E,E=L,L=u}for(u=F-S-1,s=0;s<S;++s,++u)z[u]=0;for(;T>0;)F=C[--T],1==z[F-=S+1]&&(z[F]=2,C[T++]=F),1==z[F+=1]&&(z[F]=2,C[T++]=F),1==z[F+=1]&&(z[F]=2,C[T++]=F),1==z[F+=S]&&(z[F]=2,C[T++]=F),1==z[F-=2]&&(z[F]=2,C[T++]=F),1==z[F+=S]&&(z[F]=2,C[T++]=F),1==z[F+=1]&&(z[F]=2,C[T++]=F),1==z[F+=1]&&(z[F]=2,C[T++]=F);for(F=S+1,O=0,s=0;s<i;++s,F+=S)for(u=0;u<o;++u)n[O++]=255*(2==z[F+u]);e.cache.put_buffer(x),e.cache.put_buffer(w),e.cache.put_buffer(g),e.cache.put_buffer(M)},warp_perspective:function(t,r,e,a){void 0===a&&(a=0);for(var f=0|t.cols,o=0|t.rows,i=0|r.cols,n=0|r.rows,s=t.data,u=r.data,c=0,h=0,d=0,l=0,v=0,_=0,p=0,b=0,m=0,y=0,x=0,w=0,g=0,M=0,k=0,z=e.data,C=z[0],A=z[1],R=z[2],O=z[3],E=z[4],L=z[5],S=z[6],F=z[7],T=z[8],U=0;h<n;++h)for(b=A*h+R,m=E*h+L,y=F*h+T,c=0;c<i;++c,++U,b+=C,m+=O,y+=S)l=0|(_=b*(x=1/y)),v=0|(p=m*x),_>0&&p>0&&l<f-1&&v<o-1?(w=Math.max(_-l,0),g=Math.max(p-v,0),M=s[d=f*v+l|0]+w*(s[d+1]-s[d]),k=s[d+f]+w*(s[d+f+1]-s[d+f]),u[U]=M+g*(k-M)):u[U]=a},warp_affine:function(t,r,e,a){void 0===a&&(a=0);for(var f=t.cols,o=t.rows,i=r.cols,n=r.rows,s=t.data,u=r.data,c=0,h=0,d=0,l=0,v=0,_=0,p=0,b=0,m=0,y=0,x=0,w=e.data,g=w[0],M=w[1],k=w[2],z=w[3],C=w[4],A=w[5],R=0;h<n;++h)for(_=M*h+k,p=C*h+A,c=0;c<i;++c,++R,_+=g,p+=z)v=0|p,(l=0|_)>=0&&v>=0&&l<f-1&&v<o-1?(b=_-l,m=p-v,y=s[d=f*v+l]+b*(s[d+1]-s[d]),x=s[d+f]+b*(s[d+f+1]-s[d+f]),u[R]=y+m*(x-y)):u[R]=a},skindetector:function(t,r){for(var e,a,f,o,i=t.width*t.height;i--;)o=4*i,e=t.data[o],a=t.data[o+1],f=t.data[o+2],e>95&&a>40&&f>20&&e>a&&e>f&&e-Math.min(a,f)>15&&Math.abs(e-a)>15?r[i]=255:r[i]=0}};e.imgproc=r}(),function(t){"use strict";var r=function(){var t=new Int32Array([0,3,1,3,2,2,3,1,3,0,3,-1,2,-2,1,-3,0,-3,-1,-3,-2,-2,-3,-1,-3,0,-3,1,-2,2,-1,3]),r=new Uint8Array(512),a=new Int32Array(25),f=new Int32Array(25),o=function(t,r,e,a,f){for(var o=0,i=t[r],n=f,s=0,u=0,c=0;o<25;++o)a[o]=i-t[r+e[o]];for(o=0;o<16;o+=2)s=Math.min(a[o+1],a[o+2]),(s=Math.min(s,a[o+3]))<=n||(s=Math.min(s,a[o+4]),s=Math.min(s,a[o+5]),s=Math.min(s,a[o+6]),s=Math.min(s,a[o+7]),s=Math.min(s,a[o+8]),n=Math.max(n,Math.min(s,a[o])),n=Math.max(n,Math.min(s,a[o+9])));for(u=-n,o=0;o<16;o+=2)c=Math.max(a[o+1],a[o+2]),c=Math.max(c,a[o+3]),c=Math.max(c,a[o+4]),(c=Math.max(c,a[o+5]))>=u||(c=Math.max(c,a[o+6]),c=Math.max(c,a[o+7]),c=Math.max(c,a[o+8]),u=Math.min(u,Math.max(c,a[o])),u=Math.min(u,Math.max(c,a[o+9])));return-u-1},i=20;return{set_threshold:function(t){i=Math.min(Math.max(t,0),255);for(var e=-255;e<=255;++e)r[e+255]=e<-i?1:e>i?2:0;return i},detect:function(n,s,u){void 0===u&&(u=3);var c,h=n.data,d=n.cols,l=n.rows,v=0,_=0,p=0,b=0,m=0,y=e.cache.get_buffer(3*d),x=e.cache.get_buffer(3*(d+1)<<2),w=y.u8,g=x.i32,M=a,k=f,z=Math.max(3,u),C=Math.min(l-2,l-u),A=Math.max(3,u),R=Math.min(d-3,d-u),O=0,E=0,L=o,S=r,F=i,T=0,U=0,B=0,V=0,q=0,I=0,P=0,G=0,W=0,j=0,H=0,N=0;!function(r,e,a){for(var f=0,o=t;f<a;++f)r[f]=o[f<<1]+o[1+(f<<1)]*e;for(;f<25;++f)r[f]=r[f-a]}(M,d,16);var D=M[0],Y=M[1],X=M[2],Q=M[3],Z=M[4],J=M[5],K=M[6],$=M[7],tt=M[8],rt=M[9],et=M[10],at=M[11],ft=M[12],ot=M[13],it=M[14],nt=M[15];for(v=0;v<3*d;++v)w[v]=0;for(v=z;v<C;++v){for(P=v*d+A|0,I=(m=(v-3)%3)*d|0,q=m*(d+1)|0,_=0;_<d;++_)w[I+_]=0;if(V=0,v<C-1)for(_=A;_<R;++_,++P)if(T=h[P],U=255-T,0!=(B=S[U+h[P+D]]|S[U+h[P+tt]])&&(B&=S[U+h[P+X]]|S[U+h[P+et]],B&=S[U+h[P+Z]]|S[U+h[P+ft]],0!=(B&=S[U+h[P+K]]|S[U+h[P+it]]))){if(B&=S[U+h[P+Y]]|S[U+h[P+rt]],B&=S[U+h[P+Q]]|S[U+h[P+at]],B&=S[U+h[P+J]]|S[U+h[P+ot]],1&(B&=S[U+h[P+$]]|S[U+h[P+nt]]))for(b=T-F,O=0,p=0;p<25;++p)if(h[P+M[p]]<b){if(++O>8){g[q+ ++V]=_,w[I+_]=L(h,P,M,k,F);break}}else O=0;if(2&B)for(b=T+F,O=0,p=0;p<25;++p)if(h[P+M[p]]>b){if(++O>8){g[q+ ++V]=_,w[I+_]=L(h,P,M,k,F);break}}else O=0}if(g[q+d]=V,v!=z)for(G=(m=(v-4+3)%3)*d|0,q=m*(d+1)|0,W=(m=(v-5+3)%3)*d|0,V=g[q+d],p=0;p<V;++p)j=(_=g[q+p])+1|0,H=_-1|0,(N=w[G+_])>w[G+j]&&N>w[G+H]&&N>w[W+H]&&N>w[W+_]&&N>w[W+j]&&N>w[I+H]&&N>w[I+_]&&N>w[I+j]&&((c=s[E]).x=_,c.y=v-1,c.score=N,E++)}return e.cache.put_buffer(y),e.cache.put_buffer(x),E}}}();t.fast_corners=r,r.set_threshold(20)}(e),function(t){"use strict";var r=function(){var t=function(t,r,e,a,f,o,i){var n=-2*t[r]+t[r+a]+t[r-a],s=-2*t[r]+t[r+f]+t[r-f],u=t[r+o]+t[r-o]-t[r+i]-t[r-i],c=0|Math.sqrt((n-s)*(n-s)+4*u*u);return Math.min(Math.abs(e-c),Math.abs(-(e+c)))};return{laplacian_threshold:30,min_eigen_value_threshold:25,detect:function(r,a,f){void 0===f&&(f=5);var o,i=0,n=0,s=r.cols,u=r.rows,c=r.data,h=5*s|0,d=3+3*s|0,l=3-3*s|0,v=e.cache.get_buffer(s*u<<2),_=v.i32,p=0,b=0,m=0,y=0,x=0,w=this.laplacian_threshold,g=this.min_eigen_value_threshold,M=0|Math.max(5,f),k=0|Math.max(3,f),z=0|Math.min(s-5,s-f),C=0|Math.min(u-3,u-f);for(i=s*u;--i>=0;)_[i]=0;for(function(t,r,e,a,f,o,i,n,s,u){var c=0,h=0,d=n*e+i|0,l=d;for(c=n;c<u;++c,d+=e,l=d)for(h=i;h<s;++h,++l)r[l]=-4*t[l]+t[l+f]+t[l-f]+t[l+o]+t[l-o]}(c,_,s,0,5,h,M,k,z,C),b=k*s+M|0,n=k;n<C;++n,b+=s)for(i=M,m=b;i<z;++i,++m)((p=_[m])<-w&&p<_[m-1]&&p<_[m+1]&&p<_[m-s]&&p<_[m+s]&&p<_[m-s-1]&&p<_[m+s-1]&&p<_[m-s+1]&&p<_[m+s+1]||p>w&&p>_[m-1]&&p>_[m+1]&&p>_[m-s]&&p>_[m+s]&&p>_[m-s-1]&&p>_[m+s-1]&&p>_[m-s+1]&&p>_[m+s+1])&&(y=t(c,m,p,5,h,d,l))>g&&((o=a[x]).x=i,o.y=n,o.score=y,++x,++i,++m);return e.cache.put_buffer(v),x}}}();t.yape06=r}(e),function(t){"use strict";var r=function(){var t=function(t,r,e){var a,f,o=0;for(a=e,f=0;f<a;f++,o++)a=Math.sqrt(e*e-f*f)+.5|0,r[o]=a+t*f;for(a--;a<f&&a>=0;a--,o++)f=Math.sqrt(e*e-a*a)+.5|0,r[o]=a+t*f;for(;-a<f;a--,o++)f=Math.sqrt(e*e-a*a)+.5|0,r[o]=a+t*f;for(f--;f>=0;f--,o++)a=-Math.sqrt(e*e-f*f)-.5|0,r[o]=a+t*f;for(;f>a;f--,o++)a=-Math.sqrt(e*e-f*f)-.5|0,r[o]=a+t*f;for(a++;a<=0;a++,o++)f=-Math.sqrt(e*e-a*a)-.5|0,r[o]=a+t*f;for(;a<-f;a++,o++)f=-Math.sqrt(e*e-a*a)-.5|0,r[o]=a+t*f;for(f++;f<0;f++,o++)a=Math.sqrt(e*e-f*f)+.5|0,r[o]=a+t*f;return r[o]=r[0],r[o+1]=r[1],o},r=function(t,r,e){var a=0;return 0!=t[r+1]&&a++,0!=t[r-1]&&a++,0!=t[r+e]&&a++,0!=t[r+e+1]&&a++,0!=t[r+e-1]&&a++,0!=t[r-e]&&a++,0!=t[r-e+1]&&a++,0!=t[r-e-1]&&a++,a},e=function(t,r,e,a,f){var o,i;if(e>0)for(r-=a*f,i=-f;i<=f;++i){for(o=-f;o<=f;++o)if(t[r+o]>e)return!1;r+=a}else for(r-=a*f,i=-f;i<=f;++i){for(o=-f;o<=f;++o)if(t[r+o]<e)return!1;r+=a}return!0},a=function(t,r,e,a,f,o,i,n){var s=0,u=0,c=i-1|0,h=0,d=0,l=0,v=0,_=0;if((h=t[r+o[u]])<=f)if(h>=a)if((d=t[r+o[c]])<=f){if(d>=a)return void(e[r]=0);if(c++,(l=t[r+o[c]])>f)if(c++,(v=t[r+o[c]])>f)_=3;else{if(!(v<a))return void(e[r]=0);_=6}else if(c++,(v=t[r+o[c]])>f)_=7;else{if(!(v<a))return void(e[r]=0);_=2}}else if(c++,(l=t[r+o[c]])>f)if(c++,(v=t[r+o[c]])>f)_=3;else{if(!(v<a))return void(e[r]=0);_=6}else{if(!(l<a))return void(e[r]=0);if(c++,(v=t[r+o[c]])>f)_=7;else{if(!(v<a))return void(e[r]=0);_=2}}else{if((d=t[r+o[c]])>f)return void(e[r]=0);if(c++,(l=t[r+o[c]])>f)return void(e[r]=0);if(c++,(v=t[r+o[c]])>f)return void(e[r]=0);_=1}else{if((d=t[r+o[c]])<a)return void(e[r]=0);if(c++,(l=t[r+o[c]])<a)return void(e[r]=0);if(c++,(v=t[r+o[c]])<a)return void(e[r]=0);_=0}for(u=1;u<=i;u++)switch(h=t[r+o[u]],_){case 0:if(h>f){if(l=v,c++,(v=t[r+o[c]])<a)return void(e[r]=0);s-=h+l,_=0;break}if(h<a){if(l>f)return void(e[r]=0);if(v>f)return void(e[r]=0);if(l=v,c++,(v=t[r+o[c]])>f)return void(e[r]=0);s-=h+l,_=8;break}if(l<=f)return void(e[r]=0);if(v<=f)return void(e[r]=0);if(l=v,c++,(v=t[r+o[c]])>f){s-=h+l,_=3;break}if(v<a){s-=h+l,_=6;break}return void(e[r]=0);case 1:if(h<a){if(l=v,c++,(v=t[r+o[c]])>f)return void(e[r]=0);s-=h+l,_=1;break}if(h>f){if(l<a)return void(e[r]=0);if(v<a)return void(e[r]=0);if(l=v,c++,(v=t[r+o[c]])<a)return void(e[r]=0);s-=h+l,_=9;break}if(l>=a)return void(e[r]=0);if(v>=a)return void(e[r]=0);if(l=v,c++,(v=t[r+o[c]])<a){s-=h+l,_=2;break}if(v>f){s-=h+l,_=7;break}return void(e[r]=0);case 2:if(h>f)return void(e[r]=0);if(l=v,c++,v=t[r+o[c]],h<a){if(v>f)return void(e[r]=0);s-=h+l,_=4;break}if(v>f){s-=h+l,_=7;break}if(v<a){s-=h+l,_=2;break}return void(e[r]=0);case 3:if(h<a)return void(e[r]=0);if(l=v,c++,v=t[r+o[c]],h>f){if(v<a)return void(e[r]=0);s-=h+l,_=5;break}if(v>f){s-=h+l,_=3;break}if(v<a){s-=h+l,_=6;break}return void(e[r]=0);case 4:if(h>f)return void(e[r]=0);if(h<a){if(l=v,c++,(v=t[r+o[c]])>f)return void(e[r]=0);s-=h+l,_=1;break}if(v>=a)return void(e[r]=0);if(l=v,c++,(v=t[r+o[c]])<a){s-=h+l,_=2;break}if(v>f){s-=h+l,_=7;break}return void(e[r]=0);case 5:if(h<a)return void(e[r]=0);if(h>f){if(l=v,c++,(v=t[r+o[c]])<a)return void(e[r]=0);s-=h+l,_=0;break}if(v<=f)return void(e[r]=0);if(l=v,c++,(v=t[r+o[c]])>f){s-=h+l,_=3;break}if(v<a){s-=h+l,_=6;break}return void(e[r]=0);case 7:if(h>f)return void(e[r]=0);if(h<a)return void(e[r]=0);if(l=v,c++,(v=t[r+o[c]])>f){s-=h+l,_=3;break}if(v<a){s-=h+l,_=6;break}return void(e[r]=0);case 6:if(h>f)return void(e[r]=0);if(h<a)return void(e[r]=0);if(l=v,c++,(v=t[r+o[c]])<a){s-=h+l,_=2;break}if(v>f){s-=h+l,_=7;break}return void(e[r]=0);case 8:if(h>f){if(v<a)return void(e[r]=0);if(l=v,c++,(v=t[r+o[c]])<a)return void(e[r]=0);s-=h+l,_=9;break}if(h<a){if(l=v,c++,(v=t[r+o[c]])>f)return void(e[r]=0);s-=h+l,_=1;break}return void(e[r]=0);case 9:if(h<a){if(v>f)return void(e[r]=0);if(l=v,c++,(v=t[r+o[c]])>f)return void(e[r]=0);s-=h+l,_=8;break}if(h>f){if(l=v,c++,(v=t[r+o[c]])<a)return void(e[r]=0);s-=h+l,_=0;break}return void(e[r]=0)}e[r]=s+n*t[r]},f=function(){return function(r,e,a){this.dirs=new Int32Array(1024),this.dirs_count=0|t(r,this.dirs,a),this.scores=new Int32Array(r*e),this.radius=0|a}}();return{level_tables:[],tau:7,init:function(t,r,e,a){void 0===a&&(a=1);var o;for(e=Math.min(e,7),e=Math.max(e,3),o=0;o<a;++o)this.level_tables[o]=new f(t>>o,r>>o,e)},detect:function(t,f,o){void 0===o&&(o=4);var i,n=this.level_tables[0],s=0|n.radius,u=s-1|0,c=n.dirs,h=0|n.dirs_count,d=h>>1,l=t.data,v=0|t.cols,_=0|t.rows,p=v>>1,b=n.scores,m=0,y=0,x=0,w=0,g=0,M=0,k=0,z=0,C=0|this.tau,A=0,R=0|Math.max(s+1,o),O=0|Math.max(s+1,o),E=0|Math.min(v-s-2,v-o),L=0|Math.min(_-s-2,_-o);for(x=O*v+R|0,y=O;y<L;++y,x+=v)for(m=R,w=x;m<E;++m,++w)g=l[w]+C,(M=l[w]-C)<l[w+s]&&l[w+s]<g&&M<l[w-s]&&l[w-s]<g?b[w]=0:a(l,w,b,M,g,c,d,h);for(x=O*v+R|0,y=O;y<L;++y,x+=v)for(m=R,w=x;m<E;++m,++w)z=b[w],(k=Math.abs(z))<5?(++m,++w):r(b,w,v)>=3&&e(b,w,z,p,s)&&((i=f[A]).x=m,i.y=y,i.score=k,++A,m+=u,w+=u);return A}}}();t.yape=r}(e),function(t){"use strict";var r=function(){var t=new Int32Array([8,-3,9,5,4,2,7,-12,-11,9,-8,2,7,-12,12,-13,2,-13,2,12,1,-7,1,6,-2,-10,-2,-4,-13,-13,-11,-8,-13,-3,-12,-9,10,4,11,9,-13,-8,-8,-9,-11,7,-9,12,7,7,12,6,-4,-5,-3,0,-13,2,-12,-3,-9,0,-7,5,12,-6,12,-1,-3,6,-2,12,-6,-13,-4,-8,11,-13,12,-8,4,7,5,1,5,-3,10,-3,3,-7,6,12,-8,-7,-6,-2,-2,11,-1,-10,-13,12,-8,10,-7,3,-5,-3,-4,2,-3,7,-10,-12,-6,11,5,-12,6,-7,5,-6,7,-1,1,0,4,-5,9,11,11,-13,4,7,4,12,2,-1,4,4,-4,-12,-2,7,-8,-5,-7,-10,4,11,9,12,0,-8,1,-13,-13,-2,-8,2,-3,-2,-2,3,-6,9,-4,-9,8,12,10,7,0,9,1,3,7,-5,11,-10,-13,-6,-11,0,10,7,12,1,-6,-3,-6,12,10,-9,12,-4,-13,8,-8,-12,-13,0,-8,-4,3,3,7,8,5,7,10,-7,-1,7,1,-12,3,-10,5,6,2,-4,3,-10,-13,0,-13,5,-13,-7,-12,12,-13,3,-11,8,-7,12,-4,7,6,-10,12,8,-9,-1,-7,-6,-2,-5,0,12,-12,5,-7,5,3,-10,8,-13,-7,-7,-4,5,-3,-2,-1,-7,2,9,5,-11,-11,-13,-5,-13,-1,6,0,-1,5,-3,5,2,-4,-13,-4,12,-9,-6,-9,6,-12,-10,-8,-4,10,2,12,-3,7,12,12,12,-7,-13,-6,5,-4,9,-3,4,7,-1,12,2,-7,6,-5,1,-13,11,-12,5,-3,7,-2,-6,7,-8,12,-7,-13,-7,-11,-12,1,-3,12,12,2,-6,3,0,-4,3,-2,-13,-1,-13,1,9,7,1,8,-6,1,-1,3,12,9,1,12,6,-1,-9,-1,3,-13,-13,-10,5,7,7,10,12,12,-5,12,9,6,3,7,11,5,-13,6,10,2,-12,2,3,3,8,4,-6,2,6,12,-13,9,-12,10,3,-8,4,-7,9,-11,12,-4,-6,1,12,2,-8,6,-9,7,-4,2,3,3,-2,6,3,11,0,3,-3,8,-8,7,8,9,3,-11,-5,-6,-4,-10,11,-5,10,-5,-8,-3,12,-10,5,-9,0,8,-1,12,-6,4,-6,6,-11,-10,12,-8,7,4,-2,6,7,-2,0,-2,12,-5,-8,-5,2,7,-6,10,12,-9,-13,-8,-8,-5,-13,-5,-2,8,-8,9,-13,-9,-11,-9,0,1,-8,1,-2,7,-4,9,1,-2,1,-1,-4,11,-6,12,-11,-12,-9,-6,4,3,7,7,12,5,5,10,8,0,-4,2,8,-9,12,-5,-13,0,7,2,12,-1,2,1,7,5,11,7,-9,3,5,6,-8,-13,-4,-8,9,-5,9,-3,-3,-4,-7,-3,-12,6,5,8,0,-7,6,-6,12,-13,6,-5,-2,1,-10,3,10,4,1,8,-4,-2,-2,2,-13,2,-12,12,12,-2,-13,0,-6,4,1,9,3,-6,-10,-3,-5,-3,-13,-1,1,7,5,12,-11,4,-2,5,-7,-13,9,-9,-5,7,1,8,6,7,-8,7,6,-7,-4,-7,1,-8,11,-7,-8,-13,6,-12,-8,2,4,3,9,10,-5,12,3,-6,-5,-6,7,8,-3,9,-8,2,-12,2,8,-11,-2,-10,3,-12,-13,-7,-9,-11,0,-10,-5,5,-3,11,8,-2,-13,-1,12,-1,-8,0,9,-13,-11,-12,-5,-10,-2,-10,11,-3,9,-2,-13,2,-3,3,2,-9,-13,-4,0,-4,6,-3,-10,-4,12,-2,-7,-6,-11,-4,9,6,-3,6,11,-13,11,-5,5,11,11,12,6,7,-5,12,-2,-1,12,0,7,-4,-8,-3,-2,-7,1,-6,7,-13,-12,-8,-13,-7,-2,-6,-8,-8,5,-6,-9,-5,-1,-4,5,-13,7,-8,10,1,5,5,-13,1,0,10,-13,9,12,10,-1,5,-8,10,-9,-1,11,1,-13,-9,-3,-6,2,-1,-10,1,12,-13,1,-8,-10,8,-11,10,-6,2,-13,3,-6,7,-13,12,-9,-10,-10,-5,-7,-10,-8,-8,-13,4,-6,8,5,3,12,8,-13,-4,2,-3,-3,5,-13,10,-12,4,-13,5,-1,-9,9,-4,3,0,3,3,-9,-12,1,-6,1,3,2,4,-8,-10,-10,-10,9,8,-13,12,12,-8,-12,-6,-5,2,2,3,7,10,6,11,-8,6,8,8,-12,-7,10,-6,5,-3,-9,-3,9,-1,-13,-1,5,-3,-7,-3,4,-8,-2,-8,3,4,2,12,12,2,-5,3,11,6,-9,11,-13,3,-1,7,12,11,-1,12,4,-3,0,-3,6,4,-11,4,12,2,-4,2,1,-10,-6,-8,1,-13,7,-11,1,-13,12,-11,-13,6,0,11,-13,0,-1,1,4,-13,3,-9,-2,-9,8,-6,-3,-13,-6,-8,-2,5,-9,8,10,2,7,3,-9,-1,-6,-1,-1,9,5,11,-2,11,-3,12,-8,3,0,3,5,-1,4,0,10,3,-6,4,5,-13,0,-10,5,5,8,12,11,8,9,9,-6,7,-4,8,-12,-10,4,-10,9,7,3,12,4,9,-7,10,-2,7,0,12,-2,-1,-6,0,-11]),r=new e.matrix_t(3,3,e.F32_t|e.C1_t),a=new e.matrix_t(32,32,e.U8_t|e.C1_t),f=function(t,a,f,o,i,n){var s=Math.cos(f),u=Math.sin(f);r.data[0]=s,r.data[1]=-u,r.data[2]=(-s+u)*n*.5+o,r.data[3]=u,r.data[4]=s,r.data[5]=(-u-s)*n*.5+i,e.imgproc.warp_affine(t,a,r,128)};return{describe:function(r,o,i,n){var s=0,u=0,c=0,h=0,d=0,l=0,v=0,_=0,p=(r.data,r.cols,r.rows,a.data),b=0;n.type&e.U8_t?n.resize(32,i,1):(n.type=e.U8_t,n.cols=32,n.rows=i,n.channel=1,n.allocate());var m=n.data,y=0;for(s=0;s<i;++s){for(c=o[s].x,h=o[s].y,d=o[s].angle,f(r,a,d,c,h,32),b=0,u=0;u<32;++u)_=(l=p[528+32*t[b+1]+t[b]])<(v=p[528+32*t[(b+=2)+1]+t[b]])|0,_|=((l=p[528+32*t[(b+=2)+1]+t[b]])<(v=p[528+32*t[(b+=2)+1]+t[b]]))<<1,_|=((l=p[528+32*t[(b+=2)+1]+t[b]])<(v=p[528+32*t[(b+=2)+1]+t[b]]))<<2,_|=((l=p[528+32*t[(b+=2)+1]+t[b]])<(v=p[528+32*t[(b+=2)+1]+t[b]]))<<3,_|=((l=p[528+32*t[(b+=2)+1]+t[b]])<(v=p[528+32*t[(b+=2)+1]+t[b]]))<<4,_|=((l=p[528+32*t[(b+=2)+1]+t[b]])<(v=p[528+32*t[(b+=2)+1]+t[b]]))<<5,_|=((l=p[528+32*t[(b+=2)+1]+t[b]])<(v=p[528+32*t[(b+=2)+1]+t[b]]))<<6,l=p[528+32*t[(b+=2)+1]+t[b]],v=p[528+32*t[(b+=2)+1]+t[b]],b+=2,_|=(l<v)<<7,m[y+u]=_;y+=32}}}}();t.orb=r}(e),function(t){"use strict";var r=function(){var t=e.imgproc.scharr_derivatives;return{track:function(r,a,f,o,i,n,s,u,c,h){void 0===s&&(s=30),void 0===u&&(u=new Uint8Array(i)),void 0===c&&(c=.01),void 0===h&&(h=1e-4);var d=.5*(n-1),l=n*n|0,v=l<<1,_=r.data,p=a.data,b=_[0].data,m=p[0].data,y=_[0].cols,x=_[0].rows,w=0,g=0,M=e.cache.get_buffer(l<<2),k=e.cache.get_buffer(v<<2),z=e.cache.get_buffer(x*(y<<1)<<2),C=new e.matrix_t(y,x,e.S32C2_t,z.data),A=M.i32,R=k.i32,O=z.i32,E=0,L=0,S=0,F=0,T=0,U=0,B=0,V=0,q=0,I=0,P=0,G=0,W=0,j=0,H=0,N=0,D=0,Y=0,X=0,Q=0,Z=0,J=0,K=0,$=0,tt=0,rt=0,et=0,at=0,ft=0,ot=0,it=0,nt=0,st=0,ut=0,ct=0,ht=0,dt=0,lt=0,vt=0,_t=0,pt=0,bt=0,mt=0;for(c*=c;Q<i;++Q)u[Q]=1;var yt=r.levels-1|0;for($=yt;$>=0;--$)for(B=1/(1<<$),g=x>>$,E=(w=y>>$)<<1,b=_[$].data,m=p[$].data,et=w-n|0,at=g-n|0,t(_[$],C),tt=0;tt<i;++tt)if(Q=tt<<1,Z=Q+1,V=f[Q]*B,q=f[Z]*B,$==yt?(I=V,P=q):(I=2*o[Q],P=2*o[Z]),o[Q]=I,o[Z]=P,V-=d,q-=d,N=0|V,D=0|q,0==(J=N<=0|N>=et|D<=0|D>=at)){for(ht=16384-(st=(1-(ft=V-N))*(1-(ot=q-D))*16384+.5|0)-(ut=ft*(1-ot)*16384+.5|0)-(ct=(1-ft)*ot*16384+.5|0),_t=0,pt=0,bt=0,K=0;K<n;++K)for(S=(L=(K+D)*w+N|0)<<1,T=(F=K*n|0)<<1,J=0;J<n;++J,++L,++F,S+=2)dt=(dt=b[L]*st+b[L+1]*ut+b[L+w]*ct+b[L+w+1]*ht)+256>>9,lt=(lt=O[S]*st+O[S+2]*ut+O[S+E]*ct+O[S+E+2]*ht)+8192>>14,vt=(vt=O[S+1]*st+O[S+3]*ut+O[S+E+1]*ct+O[S+E+3]*ht)+8192>>14,A[F]=dt,R[T++]=lt,R[T++]=vt,_t+=lt*lt,pt+=lt*vt,bt+=vt*vt;if(_t*=1/(1<<20),pt*=1/(1<<20),bt*=1/(1<<20),mt=_t*bt-pt*pt,(bt+_t-Math.sqrt((_t-bt)*(_t-bt)+4*pt*pt))/v<h||mt<1.1920929e-7)0==$&&(u[tt]=0);else for(mt=1/mt,I-=d,P-=d,G=0,W=0,rt=0;rt<s;++rt){if(Y=0|I,X=0|P,0!=(J=Y<=0|Y>=et|X<=0|X>=at)){0==$&&(u[tt]=0);break}for(ht=16384-(st=(1-(ft=I-Y))*(1-(ot=P-X))*16384+.5|0)-(ut=ft*(1-ot)*16384+.5|0)-(ct=(1-ft)*ot*16384+.5|0),it=0,nt=0,K=0;K<n;++K)for(U=(K+X)*w+Y|0,T=(F=K*n|0)<<1,J=0;J<n;++J,++U,++F)dt=(dt=m[U]*st+m[U+1]*ut+m[U+w]*ct+m[U+w+1]*ht)+256>>9,it+=(dt-=A[F])*R[T++],nt+=dt*R[T++];if(it*=1/(1<<20),nt*=1/(1<<20),j=(pt*nt-bt*it)*mt,H=(pt*it-_t*nt)*mt,I+=j,P+=H,o[Q]=I+d,o[Z]=P+d,j*j+H*H<=c)break;if(rt>0&&Math.abs(j+G)<.01&&Math.abs(H+W)<.01){o[Q]-=.5*j,o[Z]-=.5*H;break}G=j,W=H}}else 0==$&&(u[tt]=0);e.cache.put_buffer(M),e.cache.put_buffer(k),e.cache.put_buffer(z)}}}();t.optical_flow_lk=r}(e),function(t){"use strict";var r=function(){var t=function(t,r){var e=.25*t.width+.5|0;return r.x<=t.x+e&&r.x>=t.x-e&&r.y<=t.y+e&&r.y>=t.y-e&&r.width<=1.5*t.width+.5|0&&1.5*r.width+.5|0>=t.width};return{edges_density:.07,detect_single_scale:function(t,r,e,a,f,o,i,n){var s,u,c,h,d,l,v,_,p,b,m,y,x,w,g,M,k,z,C,A,R,O,E,L,S,F=n.size[0]*i|0,T=n.size[1]*i|0,U=.5*i+1.5|0,B=U,V=f-F|0,q=o-T|0,I=f+1|0,P=1/(F*T),G=!0,W=0,j=F,H=T*I,N=H+F,D=F*T*255*this.edges_density|0,Y=[];for(d=0;d<q;d+=B)for(W=d*I,h=0;h<V;h+=U,W+=U)if(l=t[W]-t[W+j]-t[W+H]+t[W+N],a&&(a[W]-a[W+j]-a[W+H]+a[W+N]<D||l<20))h+=U,W+=U;else{for(l*=P,_=(v=(r[W]-r[W+j]-r[W+H]+r[W+N])*P-l*l)>0?Math.sqrt(v):1,x=(p=n.complexClassifiers).length,G=!0,s=0;s<x;++s){for(M=(b=p[s]).threshold,w=(m=b.simpleClassifiers).length,k=0,u=0;u<w;++u){if(y=m[u],z=0,A=y.features,g=A.length,1===y.tilted)for(c=0;c<g;++c)R=~~(h+(C=A[c])[0]*i)+~~(d+C[1]*i)*I,O=(L=~~(C[2]*i))*I,E=(S=~~(C[3]*i))*I,z+=(e[R]-e[R+L+O]-e[R-S+E]+e[R+L-S+O+E])*C[4];else for(c=0;c<g;++c)R=~~(h+(C=A[c])[0]*i)+~~(d+C[1]*i)*I,L=~~(C[2]*i),E=(S=~~(C[3]*i))*I,z+=(t[R]-t[R+L]-t[R+E]+t[R+E+L])*C[4];k+=z*P<y.threshold*_?y.left_val:y.right_val}if(k<M){G=!1;break}}G&&(Y.push({x:h,y:d,width:F,height:T,neighbor:1,confidence:k}),h+=U,W+=U)}return Y},detect_multi_scale:function(t,r,e,a,f,o,i,n,s){void 0===n&&(n=1.2),void 0===s&&(s=1);for(var u=i.size[0],c=i.size[1],h=[];s*u<f&&s*c<o;)h=h.concat(this.detect_single_scale(t,r,e,a,f,o,s,i)),s*=n;return h},group_rectangles:function(r,e){void 0===e&&(e=1);var a,f,o=r.length,i=[];for(a=0;a<o;++a)i[a]={parent:-1,element:r[a],rank:0};for(a=0;a<o;++a)if(i[a].element){for(var n=a;-1!=i[n].parent;)n=i[n].parent;for(f=0;f<o;++f)if(a!=f&&i[f].element&&t(i[a].element,i[f].element)){for(var s=f;-1!=i[s].parent;)s=i[s].parent;if(s!=n){i[n].rank>i[s].rank?i[s].parent=n:(i[n].parent=s,i[n].rank==i[s].rank&&i[s].rank++,n=s);for(var u,c=f;-1!=i[c].parent;)u=c,c=i[c].parent,i[u].parent=n;for(c=a;-1!=i[c].parent;)u=c,c=i[c].parent,i[u].parent=n}}}var h=[],d=0;for(a=0;a<o;a++){f=-1;var l=a;if(i[l].element){for(;-1!=i[l].parent;)l=i[l].parent;i[l].rank>=0&&(i[l].rank=~d++),f=~i[l].rank}h[a]=f}var v=[];for(a=0;a<d+1;++a)v[a]={neighbors:0,x:0,y:0,width:0,height:0,confidence:0};for(a=0;a<o;++a){var _=r[a],p=h[a];0==v[p].neighbors&&(v[p].confidence=_.confidence),++v[p].neighbors,v[p].x+=_.x,v[p].y+=_.y,v[p].width+=_.width,v[p].height+=_.height,v[p].confidence=Math.max(v[p].confidence,_.confidence)}var b=[];for(a=0;a<d;++a)(o=v[a].neighbors)>=e&&b.push({x:(2*v[a].x+o)/(2*o),y:(2*v[a].y+o)/(2*o),width:(2*v[a].width+o)/(2*o),height:(2*v[a].height+o)/(2*o),neighbors:v[a].neighbors,confidence:v[a].confidence});var m=[];for(o=b.length,a=0;a<o;++a){var _=b[a],y=!0;for(f=0;f<o;++f){var x=b[f],w=.25*x.width+.5|0;if(a!=f&&_.x>=x.x-w&&_.y>=x.y-w&&_.x+_.width<=x.x+x.width+w&&_.y+_.height<=x.y+x.height+w&&(x.neighbors>Math.max(3,_.neighbors)||_.neighbors<3)){y=!1;break}}y&&m.push(_)}return m}}}();t.haar=r}(e),function(t){"use strict";var r=function(){var t=function(t,r){var e=.25*t.width+.5|0;return r.x<=t.x+e&&r.x>=t.x-e&&r.y<=t.y+e&&r.y>=t.y-e&&r.width<=1.5*t.width+.5|0&&1.5*r.width+.5|0>=t.width},r=new e.pyramid_t(1);return{interval:4,scale:1.1486,next:5,scale_to:1,prepare_cascade:function(t){for(var r=t.stage_classifier.length,e=0;e<r;e++)for(var a=t.stage_classifier[e].feature,f=t.stage_classifier[e].count,o=t.stage_classifier[e]._feature=new Array(f),i=0;i<f;i++)o[i]={size:a[i].size,px:new Array(a[i].size),pz:new Array(a[i].size),nx:new Array(a[i].size),nz:new Array(a[i].size)}},build_pyramid:function(t,a,f,o){void 0===o&&(o=4);var i=t.cols,n=t.rows,s=0,u=0,c=0,h=!1,d=t,l=t,v=e.U8_t|e.C1_t;this.interval=o,this.scale=Math.pow(2,1/(this.interval+1)),this.next=this.interval+1|0,this.scale_to=Math.log(Math.min(i/a,n/f))/Math.log(this.scale)|0;var _=4*(this.scale_to+2*this.next)|0;for(r.levels!=_&&(r.levels=_,r.data=new Array(_),h=!0,r.data[0]=t),s=1;s<=this.interval;++s)u=i/Math.pow(this.scale,s)|0,c=n/Math.pow(this.scale,s)|0,d=r.data[s<<2],(h||u!=d.cols||c!=d.rows)&&(r.data[s<<2]=new e.matrix_t(u,c,v),d=r.data[s<<2]),e.imgproc.resample(t,d,u,c);for(s=this.next;s<this.scale_to+2*this.next;++s)l=r.data[(s<<2)-(this.next<<2)],d=r.data[s<<2],u=l.cols>>1,c=l.rows>>1,(h||u!=d.cols||c!=d.rows)&&(r.data[s<<2]=new e.matrix_t(u,c,v),d=r.data[s<<2]),e.imgproc.pyrdown(l,d);for(s=2*this.next;s<this.scale_to+2*this.next;++s)u=(l=r.data[(s<<2)-(this.next<<2)]).cols>>1,c=l.rows>>1,d=r.data[1+(s<<2)],(h||u!=d.cols||c!=d.rows)&&(r.data[1+(s<<2)]=new e.matrix_t(u,c,v),d=r.data[1+(s<<2)]),e.imgproc.pyrdown(l,d,1,0),d=r.data[2+(s<<2)],(h||u!=d.cols||c!=d.rows)&&(r.data[2+(s<<2)]=new e.matrix_t(u,c,v),d=r.data[2+(s<<2)]),e.imgproc.pyrdown(l,d,0,1),d=r.data[3+(s<<2)],(h||u!=d.cols||c!=d.rows)&&(r.data[3+(s<<2)]=new e.matrix_t(u,c,v),d=r.data[3+(s<<2)]),e.imgproc.pyrdown(l,d,1,1);return r},detect:function(t,r){this.interval;var e,a,f,o,i,n=this.scale,s=this.next,u=this.scale_to,c=0,h=0,d=0,l=0,v=0,_=0,p=0,b=0,m=0,y=0,x=0,w=0,g=0,M=0,k=0,z=0,C=0,A=0,R=!0,O=!0,E=1,L=1,S=[0,1,0,1],F=[0,0,1,1],T=[],U=t.data,B=[],V=[0,0,0],q=[0,0,0],I=[0,0,0];for(c=0;c<u;c++){for(z=U[(k=c<<2)+(s<<3)].cols-(r.width>>2),C=U[k+(s<<3)].rows-(r.height>>2),q[0]=1*U[k].cols,q[1]=1*U[k+(s<<2)].cols,q[2]=1*U[k+(s<<3)].cols,I[0]=4*U[k].cols-4*z,I[1]=2*U[k+(s<<2)].cols-2*z,I[2]=1*U[k+(s<<3)].cols-1*z,b=r.stage_classifier.length,h=0;h<b;h++)for(f=r.stage_classifier[h].feature,a=r.stage_classifier[h]._feature,m=r.stage_classifier[h].count,d=0;d<m;d++)for(o=a[d],y=0|(i=f[d]).size,p=0;p<y;p++)o.px[p]=1*i.px[p]+i.py[p]*q[i.pz[p]],o.pz[p]=i.pz[p],o.nx[p]=1*i.nx[p]+i.ny[p]*q[i.nz[p]],o.nz[p]=i.nz[p];for(B[0]=U[k].data,B[1]=U[k+(s<<2)].data,p=0;p<4;p++)for(B[2]=U[k+(s<<3)+p].data,V[0]=2*S[p]+F[p]*(2*U[k].cols),V[1]=1*S[p]+F[p]*(1*U[k+(s<<2)].cols),V[2]=0,_=0;_<C;_++){for(v=0;v<z;v++){for(A=0,R=!0,b=r.stage_classifier.length,h=0;h<b;h++){for(A=0,e=r.stage_classifier[h].alpha,a=r.stage_classifier[h]._feature,m=r.stage_classifier[h].count,d=0;d<m;d++)if(o=a[d],w=B[o.pz[0]][V[o.pz[0]]+o.px[0]],g=B[o.nz[0]][V[o.nz[0]]+o.nx[0]],w<=g)A+=e[d<<1];else{for(O=!0,y=o.size,M=1;M<y;M++){if(o.pz[M]>=0&&(x=B[o.pz[M]][V[o.pz[M]]+o.px[M]])<w){if(x<=g){O=!1;break}w=x}if(o.nz[M]>=0&&(l=B[o.nz[M]][V[o.nz[M]]+o.nx[M]])>g){if(w<=l){O=!1;break}g=l}}A+=O?e[1+(d<<1)]:e[d<<1]}if(A<r.stage_classifier[h].threshold){R=!1;break}}R&&(T.push({x:(4*v+2*S[p])*E,y:(4*_+2*F[p])*L,width:r.width*E,height:r.height*L,neighbor:1,confidence:A}),++v,V[0]+=4,V[1]+=2,V[2]+=1),V[0]+=4,V[1]+=2,V[2]+=1}V[0]+=I[0],V[1]+=I[1],V[2]+=I[2]}E*=n,L*=n}return T},group_rectangles:function(r,e){void 0===e&&(e=1);var a,f,o=r.length,i=[];for(a=0;a<o;++a)i[a]={parent:-1,element:r[a],rank:0};for(a=0;a<o;++a)if(i[a].element){for(var n=a;-1!=i[n].parent;)n=i[n].parent;for(f=0;f<o;++f)if(a!=f&&i[f].element&&t(i[a].element,i[f].element)){for(var s=f;-1!=i[s].parent;)s=i[s].parent;if(s!=n){i[n].rank>i[s].rank?i[s].parent=n:(i[n].parent=s,i[n].rank==i[s].rank&&i[s].rank++,n=s);for(var u,c=f;-1!=i[c].parent;)u=c,c=i[c].parent,i[u].parent=n;for(c=a;-1!=i[c].parent;)u=c,c=i[c].parent,i[u].parent=n}}}var h=[],d=0;for(a=0;a<o;a++){f=-1;var l=a;if(i[l].element){for(;-1!=i[l].parent;)l=i[l].parent;i[l].rank>=0&&(i[l].rank=~d++),f=~i[l].rank}h[a]=f}var v=[];for(a=0;a<d+1;++a)v[a]={neighbors:0,x:0,y:0,width:0,height:0,confidence:0};for(a=0;a<o;++a){var _=r[a],p=h[a];0==v[p].neighbors&&(v[p].confidence=_.confidence),++v[p].neighbors,v[p].x+=_.x,v[p].y+=_.y,v[p].width+=_.width,v[p].height+=_.height,v[p].confidence=Math.max(v[p].confidence,_.confidence)}var b=[];for(a=0;a<d;++a)(o=v[a].neighbors)>=e&&b.push({x:(2*v[a].x+o)/(2*o),y:(2*v[a].y+o)/(2*o),width:(2*v[a].width+o)/(2*o),height:(2*v[a].height+o)/(2*o),neighbors:v[a].neighbors,confidence:v[a].confidence});var m=[];for(o=b.length,a=0;a<o;++a){var _=b[a],y=!0;for(f=0;f<o;++f){var x=b[f],w=.25*x.width+.5|0;if(a!=f&&_.x>=x.x-w&&_.y>=x.y-w&&_.x+_.width<=x.x+x.width+w&&_.y+_.height<=x.y+x.height+w&&(x.neighbors>Math.max(3,_.neighbors)||_.neighbors<3)){y=!1;break}}y&&m.push(_)}return m}}}();t.bbf=r}(e),function(r){"use strict";void 0===t||void 0===t.exports?window.jsfeat=r:t.exports=r}(e)},function(t,r,e){"use strict";function a(t){return(t-n[0][2])/n[0][0]}function f(t){return(t-n[1][2])/n[1][1]}Object.defineProperty(r,"__esModule",{value:!0});var o=function(t){return t&&t.__esModule?t:{default:t}}(e(7)),i=100,n=[[800,0,75],[0,800,75],[0,0,1]];r.default=function(t,r){for(var e=void 0,n=void 0,s=[],u=[],c=0;c<t.length;c+=2)s.push(a(t[c])),s.push(f(t[c+1])),u.push(a(r[c])),u.push(f(r[c+1]));for(var h=0;h<i;){for(var d=[],l=[],v={},_=0;_<5;_++){for(var p=Math.floor(Math.random()*(t.length/2));v[p];)p=Math.floor(Math.random()*(t.length/2));var b=[s[2*p],s[2*p+1]],m=[u[2*p],u[2*p+1]];d.push(b),l.push(m),v[p]=!0}var y=(0,o.default)(d,l),x=y.Ematrices,w=y.nroots;if(0!==w){for(var g=void 0,M=void 0,k=0;k<w;k++){var z=x[k],C=z[0][0]*d[0][0]*l[0][0]+z[0][1]*d[0][1]*l[0][0]+z[0][2]*l[0][0]+z[1][0]*d[0][0]*l[0][1]+z[1][1]*d[0][1]*l[0][1]+z[1][2]*l[0][1]+z[2][0]*d[0][0]+z[2][1]*d[0][1]+z[2][2];C=Math.abs(C),void 0===M?(M=C,g=z):C<M&&(M=C,g=z)}for(var A=0,R=0;R<s.length;R+=2){var O=g[0][0]*s[R]*u[R]+g[0][1]*s[R+1]*u[R]+g[0][2]*u[R]+g[1][0]*s[R]*u[R+1]+g[1][1]*s[R+1]*u[R+1]+g[1][2]*u[R+1]+g[2][0]*s[R]+g[2][1]*s[R+1]+g[2][2];(O=Math.abs(O))<1e-10&&A++}(void 0===n||A>n)&&(n=A,e=g),h++}}return e}},function(t,r,e){"use strict";function a(t,r,e){var a=[];if(r)for(var f=0;f<t;f++)if(a.push([]),e)for(var o=0;o<r;o++){a[f].push([]);for(var i=0;i<e;i++)a[f][o].push(0)}else for(var n=0;n<r;n++)a[f].push(0);else for(var s=0;s<t;s++)a.push(0);return a}function f(t,r){var e=a(4,4);return e[0][0]=t[0]*r[0],e[0][1]=t[0]*r[1],e[0][2]=t[0]*r[2],e[0][3]=t[0]*r[3],e[0][1]+=t[1]*r[0],e[1][1]=t[1]*r[1],e[1][2]=t[1]*r[2],e[1][3]=t[1]*r[3],e[0][2]+=t[2]*r[0],e[1][2]+=t[2]*r[1],e[2][2]=t[2]*r[2],e[2][3]=t[2]*r[3],e[0][3]+=t[3]*r[0],e[1][3]+=t[3]*r[1],e[2][3]+=t[3]*r[2],e[3][3]=t[3]*r[3],e}function o(t,r){var e=a(4,4,4);return e[0][0][0]=t[0][0]*r[0],e[0][0][1]=t[0][0]*r[1],e[0][0][2]=t[0][0]*r[2],e[0][0][3]=t[0][0]*r[3],e[0][0][1]+=t[0][1]*r[0],e[0][1][1]=t[0][1]*r[1],e[0][1][2]=t[0][1]*r[2],e[0][1][3]=t[0][1]*r[3],e[0][0][2]+=t[0][2]*r[0],e[0][1][2]+=t[0][2]*r[1],e[0][2][2]=t[0][2]*r[2],e[0][2][3]=t[0][2]*r[3],e[0][0][3]+=t[0][3]*r[0],e[0][1][3]+=t[0][3]*r[1],e[0][2][3]+=t[0][3]*r[2],e[0][3][3]=t[0][3]*r[3],e[0][1][1]+=t[1][1]*r[0],e[1][1][1]=t[1][1]*r[1],e[1][1][2]=t[1][1]*r[2],e[1][1][3]=t[1][1]*r[3],e[0][1][2]+=t[1][2]*r[0],e[1][1][2]+=t[1][2]*r[1],e[1][2][2]=t[1][2]*r[2],e[1][2][3]=t[1][2]*r[3],e[0][1][3]+=t[1][3]*r[0],e[1][1][3]+=t[1][3]*r[1],e[1][2][3]+=t[1][3]*r[2],e[1][3][3]=t[1][3]*r[3],e[0][2][2]+=t[2][2]*r[0],e[1][2][2]+=t[2][2]*r[1],e[2][2][2]=t[2][2]*r[2],e[2][2][3]=t[2][2]*r[3],e[0][2][3]+=t[2][3]*r[0],e[1][2][3]+=t[2][3]*r[1],e[2][2][3]+=t[2][3]*r[2],e[2][3][3]=t[2][3]*r[3],e[0][3][3]+=t[3][3]*r[0],e[1][3][3]+=t[3][3]*r[1],e[2][3][3]+=t[3][3]*r[2],e[3][3][3]=t[3][3]*r[3],e}function i(t,r){var e=a(4,4,4);return e[0][0][0]=t[0][0][0]*r,e[0][0][1]=t[0][0][1]*r,e[0][0][2]=t[0][0][2]*r,e[0][0][3]=t[0][0][3]*r,e[0][1][1]=t[0][1][1]*r,e[0][1][2]=t[0][1][2]*r,e[0][1][3]=t[0][1][3]*r,e[0][2][2]=t[0][2][2]*r,e[0][2][3]=t[0][2][3]*r,e[0][3][3]=t[0][3][3]*r,e[1][1][1]=t[1][1][1]*r,e[1][1][2]=t[1][1][2]*r,e[1][1][3]=t[1][1][3]*r,e[1][2][2]=t[1][2][2]*r,e[1][2][3]=t[1][2][3]*r,e[1][3][3]=t[1][3][3]*r,e[2][2][2]=t[2][2][2]*r,e[2][2][3]=t[2][2][3]*r,e[2][3][3]=t[2][3][3]*r,e[3][3][3]=t[3][3][3]*r,e}function n(t,r){var e=a(4,4,4);return e[0][0][0]=t[0][0][0]+r[0][0][0],e[0][0][1]=t[0][0][1]+r[0][0][1],e[0][0][2]=t[0][0][2]+r[0][0][2],e[0][0][3]=t[0][0][3]+r[0][0][3],e[0][1][1]=t[0][1][1]+r[0][1][1],e[0][1][2]=t[0][1][2]+r[0][1][2],e[0][1][3]=t[0][1][3]+r[0][1][3],e[0][2][2]=t[0][2][2]+r[0][2][2],e[0][2][3]=t[0][2][3]+r[0][2][3],e[0][3][3]=t[0][3][3]+r[0][3][3],e[1][1][1]=t[1][1][1]+r[1][1][1],e[1][1][2]=t[1][1][2]+r[1][1][2],e[1][1][3]=t[1][1][3]+r[1][1][3],e[1][2][2]=t[1][2][2]+r[1][2][2],e[1][2][3]=t[1][2][3]+r[1][2][3],e[1][3][3]=t[1][3][3]+r[1][3][3],e[2][2][2]=t[2][2][2]+r[2][2][2],e[2][2][3]=t[2][2][3]+r[2][2][3],e[2][3][3]=t[2][3][3]+r[2][3][3],e[3][3][3]=t[3][3][3]+r[3][3][3],e}function s(t,r){t[0][0][0]+=r[0][0][0],t[0][0][1]+=r[0][0][1],t[0][0][2]+=r[0][0][2],t[0][0][3]+=r[0][0][3],t[0][1][1]+=r[0][1][1],t[0][1][2]+=r[0][1][2],t[0][1][3]+=r[0][1][3],t[0][2][2]+=r[0][2][2],t[0][2][3]+=r[0][2][3],t[0][3][3]+=r[0][3][3],t[1][1][1]+=r[1][1][1],t[1][1][2]+=r[1][1][2],t[1][1][3]+=r[1][1][3],t[1][2][2]+=r[1][2][2],t[1][2][3]+=r[1][2][3],t[1][3][3]+=r[1][3][3],t[2][2][2]+=r[2][2][2],t[2][2][3]+=r[2][2][3],t[2][3][3]+=r[2][3][3],t[3][3][3]+=r[3][3][3]}function u(t,r){var e=a(4,4,4);return e[0][0][0]=t[0][0][0]-r[0][0][0],e[0][0][1]=t[0][0][1]-r[0][0][1],e[0][0][2]=t[0][0][2]-r[0][0][2],e[0][0][3]=t[0][0][3]-r[0][0][3],e[0][1][1]=t[0][1][1]-r[0][1][1],e[0][1][2]=t[0][1][2]-r[0][1][2],e[0][1][3]=t[0][1][3]-r[0][1][3],e[0][2][2]=t[0][2][2]-r[0][2][2],e[0][2][3]=t[0][2][3]-r[0][2][3],e[0][3][3]=t[0][3][3]-r[0][3][3],e[1][1][1]=t[1][1][1]-r[1][1][1],e[1][1][2]=t[1][1][2]-r[1][1][2],e[1][1][3]=t[1][1][3]-r[1][1][3],e[1][2][2]=t[1][2][2]-r[1][2][2],e[1][2][3]=t[1][2][3]-r[1][2][3],e[1][3][3]=t[1][3][3]-r[1][3][3],e[2][2][2]=t[2][2][2]-r[2][2][2],e[2][2][3]=t[2][2][3]-r[2][2][3],e[2][3][3]=t[2][3][3]-r[2][3][3],e[3][3][3]=t[3][3][3]-r[3][3][3],e}function c(t,r){var e=a(4,4);return e[0][0]=t[0][0]+r[0][0],e[0][1]=t[0][1]+r[0][1],e[0][2]=t[0][2]+r[0][2],e[0][3]=t[0][3]+r[0][3],e[1][1]=t[1][1]+r[1][1],e[1][2]=t[1][2]+r[1][2],e[1][3]=t[1][3]+r[1][3],e[2][2]=t[2][2]+r[2][2],e[2][3]=t[2][3]+r[2][3],e[3][3]=t[3][3]+r[3][3],e}function h(t,r){t[0][0]+=r[0][0],t[0][1]+=r[0][1],t[0][2]+=r[0][2],t[0][3]+=r[0][3],t[1][1]+=r[1][1],t[1][2]+=r[1][2],t[1][3]+=r[1][3],t[2][2]+=r[2][2],t[2][3]+=r[2][3],t[3][3]+=r[3][3]}function d(t,r){var e=a(4,4);return e[0][0]=t[0][0]-r[0][0],e[0][1]=t[0][1]-r[0][1],e[0][2]=t[0][2]-r[0][2],e[0][3]=t[0][3]-r[0][3],e[1][1]=t[1][1]-r[1][1],e[1][2]=t[1][2]-r[1][2],e[1][3]=t[1][3]-r[1][3],e[2][2]=t[2][2]-r[2][2],e[2][3]=t[2][3]-r[2][3],e[3][3]=t[3][3]-r[3][3],e}function l(t,r,e){r[0][e][0]=t[3][3][3],r[0][e][1]=t[1][3][3],r[0][e][2]=t[2][3][3],r[0][e][3]=t[1][1][3],r[0][e][5]=t[2][2][3],r[0][e][4]=t[1][2][3],r[0][e][6]=t[1][1][1],r[0][e][7]=t[1][1][2],r[0][e][8]=t[1][2][2],r[0][e][9]=t[2][2][2],r[1][e][0]=t[0][3][3],r[1][e][1]=t[0][1][3],r[1][e][2]=t[0][2][3],r[1][e][3]=t[0][1][1],r[1][e][5]=t[0][2][2],r[1][e][4]=t[0][1][2],r[2][e][0]=t[0][0][3],r[2][e][1]=t[0][0][1],r[2][e][2]=t[0][0][2],r[3][e][0]=t[0][0][0]}function v(t,r){var e=function(t){var r=f(t[0][0],t[0][0]),e=f(t[0][1],t[0][1]),a=f(t[0][2],t[0][2]),o=f(t[1][0],t[1][0]),i=f(t[1][1],t[1][1]),n=f(t[1][2],t[1][2]),s=f(t[2][0],t[2][0]),u=f(t[2][1],t[2][1]),h=f(t[2][2],t[2][2]),d=c(c(r,e),c(a,o)),l=c(c(i,n),c(s,u));return c(c(h,d),l)}(t);l(function(t){var r=d(f(t[1][1],t[2][2]),f(t[2][1],t[1][2])),e=d(f(t[2][1],t[0][2]),f(t[0][1],t[2][2])),a=d(f(t[0][1],t[1][2]),f(t[1][1],t[0][2])),i=o(r,t[0][0]),s=o(e,t[1][0]),u=o(a,t[2][0]);return n(n(i,s),u)}(t),r,0);for(var v=1,_=0;_<3;_++){for(var p=[],b=0;b<3;b++)p.push(a(4,4,4));for(var m=0;m<3;m++){for(var y=a(4,4),x=0;x<3;x++)h(y,f(t[_][x],t[m][x]));for(var w=0;w<3;w++)s(p[w],o(y,t[m][w]))}for(var g=0;g<3;g++)l(u(i(p[g],2),o(e,t[_][g])),r,v++)}}function _(t,r,e,a){for(var f=t[a][r][e],o=0;o<r;o++){for(var i=t[a][o][e]/f,n=0;n<=e;n++)t[0][o][n]-=i*t[0][r][n];for(var s=0;s<6;s++)t[1][o][s]-=i*t[1][r][s];for(var u=0;u<3;u++)t[2][o][u]-=i*t[2][r][u];for(var c=0;c<1;c++)t[3][o][c]-=i*t[3][r][c]}}function p(t,r,e,a,f){for(var o=t[a][r][e],i=r+1;i<=f;i++){for(var n=t[a][i][e]/o,s=0;s<=e;s++)t[0][i][s]-=n*t[0][r][s];for(var u=0;u<6;u++)t[1][i][u]-=n*t[1][r][u];for(var c=0;c<3;c++)t[2][i][c]-=n*t[2][r][c];for(var h=0;h<1;h++)t[3][i][h]-=n*t[3][r][h]}}function b(t,r,e,a){for(var f=-1,o=-1,i=0;i<=a;i++)i!=r&&Math.abs(t[e][i][r])>f&&(o=i,f=Math.abs(t[e][i][r]));var n=void 0;n=t[e][o][r]*t[e][r][r]<0?-1:1;for(var s=0;s<=r;s++)t[0][r][s]+=n*t[0][o][s];for(var u=0;u<6;u++)t[1][r][u]+=n*t[1][o][u];for(var c=0;c<3;c++)t[2][r][c]+=n*t[2][o][c];for(var h=0;h<1;h++)t[3][r][h]+=n*t[3][o][h]}function m(t,r,e,f,o){for(var i=a(7),n=0;n<=3;n++)for(var s=0;s<=3;s++)i[n+s]+=t[n][f][1]*t[s][o][2]-t[n][o][1]*t[s][f][2];for(var u=0;u<=6;u++)for(var c=0;c<=4;c++)r[u+c]+=t[c][e][0]*i[u]}function y(t,r,e,f){for(var o=e*e,i=o*e,n=i*e,s=a(3,3),u=0;u<3;u++){for(var c=0;c<3;c++)s[u][c]=r[0][u][c]+e*r[1][u][c]+o*r[2][u][c]+i*r[3][u][c];s[u][0]+=n*r[4][u][0]}for(var h=function(t){var r=void 0,e=void 0,a=void 0,f=Math.abs(t[0][2]),o=Math.abs(t[1][2]),i=Math.abs(t[2][2]),n=(1+(a=f>o?f>i?0:2:o>i?1:2))%3,s=(a+2)%3,u=t[n][2]/t[a][2];t[n][0]-=u*t[a][0],t[n][1]-=u*t[a][1],u=t[s][2]/t[a][2],t[s][0]-=u*t[a][0],t[s][1]-=u*t[a][1];var c=Math.abs(t[n][1])>Math.abs(t[s][1])?n:s;return r=-t[c][0]/t[c][1],e=-(t[a][0]+t[a][1]*r)/t[a][2],{x:r,y:e}}(s),d=h.x,l=h.y,v=0;v<3;v++)for(var _=0;_<3;_++){var p=t[v][_];f[v][_]=e*p[0]+d*p[1]+l*p[2]+p[3]}}function x(t,r){for(var e=[],f=0;f<10;f++)e[f]=a(3,3);var o=0,i=a(5,10,10),n=a(3,3,4);if(!function(t,r,e,f){for(var o=a(9,9),i=0;i<5;i++)o[i][0]=r[i][0]*t[i][0],o[i][1]=r[i][0]*t[i][1],o[i][2]=r[i][0],o[i][3]=r[i][1]*t[i][0],o[i][4]=r[i][1]*t[i][1],o[i][5]=r[i][1],o[i][6]=t[i][0],o[i][7]=t[i][1],o[i][8]=1;return!!function(t,r){for(var e=8;e>4;e--){var a=e-4,f=t[a][e];if(0===f)return!1;for(var o=0;o<a;o++)for(var i=t[o][e]/f,n=0;n<e;n++)t[o][n]-=i*t[a][n]}for(var s=4;s<8;s++){var u=s-4,c=t[u][s];if(0===c)return!1;for(var h=u+1;h<=4;h++)for(var d=t[h][s]/c,l=0;l<4;l++)t[h][l]-=d*t[u][l]}var v=void 0;return r[0][0]=[1,0,0,0],r[0][1]=[0,1,0,0],r[0][2]=[0,0,1,0],r[1][0]=[0,0,0,1],v=-1/t[0][4],r[1][1]=[v*t[0][0],v*t[0][1],v*t[0][2],v*t[0][3]],v=-1/t[1][5],r[1][2]=[v*t[1][0],v*t[1][1],v*t[1][2],v*t[1][3]],v=-1/t[2][6],r[2][0]=[v*t[2][0],v*t[2][1],v*t[2][2],v*t[2][3]],v=-1/t[3][7],r[2][1]=[v*t[3][0],v*t[3][1],v*t[3][2],v*t[3][3]],v=-1/t[4][8],r[2][2]=[v*t[4][0],v*t[4][1],v*t[4][2],v*t[4][3]],!0}(o,e)&&(v(e,f),!0)}(t,r,n,i))return{nroots:o,Ematrices:e};!function(t){b(t,9,0,8),_(t,9,9,0),b(t,8,0,7),_(t,8,8,0),b(t,7,0,6),_(t,7,7,0),b(t,6,0,5),_(t,6,6,0),b(t,5,0,4),_(t,5,5,0),b(t,4,0,3),_(t,4,4,0),b(t,3,0,2),_(t,3,3,0),p(t,3,3,0,5),p(t,4,4,0,5),_(t,2,5,1),_(t,1,4,1),p(t,0,3,1,5),p(t,1,4,1,5),p(t,2,5,1,5);for(var r=0;r<3;r++){var e=t[1][r][3+r]/t[0][3+r][3+r];t[4][r][0]=-t[3][r+3][0]*e;for(var a=0;a<3;a++)t[3][r][a]-=t[2][r+3][a]*e,t[2][r][a]-=t[1][r+3][a]*e,t[1][r][a]-=t[0][r+3][a]*e}}(i);var s=a(g+1);!function(t,r){m(t,r,0,1,2),m(t,r,1,2,0),m(t,r,2,0,1)}(i,s);var u=a(g);o=(0,w.default)(s,g,u);for(var c=0;c<o;c++)y(n,i,u[c],e[c]);return{nroots:o,Ematrices:e}}Object.defineProperty(r,"__esModule",{value:!0});var w=function(t){return t&&t.__esModule?t:{default:t}}(e(8)),g=10;r.default=x},function(t,r,e){"use strict";function a(){this.order,this.coef=[]}function f(t,r,e){var a=t,f=r[t];for(a--;a>=0;a--)f=e*f+r[a];return f}function o(t,r,e,a,f,o,i){var n=void 0,s=void 0,u=void 0,h=void 0,l=t,v=void 0,_=void 0;if(o){var p=e;e=1/a,a=1/p}if(o)for(_=v=r[0],h=1;h<=l;h++)v=e*v+r[h],_=a*_+r[h];else for(_=v=r[l],h=l-1;h>=0;h--)v=e*v+r[h],_=a*_+r[h];if(v*_>0)return 0;if(Math.abs(v)<c)return f[i]=o?1/e:e,1;if(Math.abs(_)<c)return f[i]=o?1/a:a,1;for(u=v,n=0;n<d;n++){var b=(_*e-v*a)/(_-v);if(o)for(s=r[0],h=1;h<=l;h++)s=b*s+r[h];else for(s=r[l],h=l-1;h>=0;h--)s=b*s+r[h];if(Math.abs(b)>c&&Math.abs(s/b)<c)return f[i]=o?1/b:b,1;if(Math.abs(s)<c)return f[i]=o?1/b:b,1;if(v*s<0?(a=b,_=s,u*s>0&&(v/=2)):(e=b,v=s,u*s>0&&(_/=2)),Math.abs(a-e)<Math.abs(c*e))return f[i]=o?1/e:e,1;u=s}if(o)for(_=v=r[0],h=1;h<=l;h++)v=e*v+r[h],_=a*_+r[h];else for(_=v=r[l],h=l-1;h>=0;h--)v=e*v+r[h],_=a*_+r[h];return 0}function i(t,r,e){for(var a=void 0,f=void 0,o=0;o<=t.ord;o++)e.coef[o]=t.coef[o];if(r.coef[r.ord]<0){for(f=t.ord-r.ord-1;f>=0;f-=2)e.coef[f]=-e.coef[f];for(f=t.ord-r.ord;f>=0;f--)for(a=r.ord+f-1;a>=f;a--)e.coef[a]=-e.coef[a]-e.coef[r.ord+f]*r.coef[a-f]}else for(f=t.ord-r.ord;f>=0;f--)for(a=r.ord+f-1;a>=f;a--)e.coef[a]-=e.coef[r.ord+f]*r.coef[a-f];for(f=r.ord-1;f>=0&&Math.abs(e.coef[f])<l;)e.coef[f]=0,f--;return e.ord=f<0?0:f,e.ord}function n(t,r,e){for(var a=0,o=f(r[0].ord,r[0].coef,e),i=1;i<=t;i++){var n=f(r[i].ord,r[i].coef,e);(0==o||o*n<0)&&a++,o=n}return a}function s(t,r,e,a,f,i,u,h){var l=void 0,v=void 0,_=void 0,p=0,b=0;if(1==f-i){if(function(t,r,e,a,f,i){var n=void 0,s=t,u=0,c=0,h=0,d=0;if(e>a){var l=e;e=a,a=l}if(a<=1&&e>=-1)return o(t,r,e,a,f,!1,i);if(e>=1||a<=-1)return o(t,r,e,a,f,1,i);for(n=s-1;n>=0;n--)u=r[n]+u,c=r[n]-c,h=e*h+r[n],d=a*d+r[n];return e<-1&&a>1?h*c<0?o(t,r,e,-1,f,1,i):d*u<0?o(t,r,1,a,f,1,i):o(t,r,-1,1,f,!1,i):e<-1?h*c<0?o(t,r,e,-1,f,1,i):o(t,r,-1,a,f,!1,i):d*u<0?o(t,r,1,a,f,1,i):o(t,r,e,1,f,!1,i)}(r[0].ord,r[0].coef,e,a,u,h))return 1;for(_=0;_<d;_++){if(l=double((e+a)/2),v=n(t,r,l),Math.abs(l)>c){if(Math.abs((a-e)/l)<c)return u[0]=l,1}else if(Math.abs(a-e)<c)return u[0]=l,1;f-v==0?e=l:a=l}return _==d&&(u[0]=l),1}for(_=0;_<d;_++){if(l=(e+a)/2,v=n(t,r,l),p=f-v,b=v-i,0!=p&&0!=b){s(t,r,e,l,f,v,u,h),s(t,r,l,a,v,i,u,h+p);break}0==p?e=l:a=l}if(_==d)for(p=i;p<f;p++)u[p-i]=l;return 1}function u(t,r,e,f){for(var o=[],u=0;u<v+1;u++)o.push(new a);var c=void 0,d=void 0,l=void 0,_=void 0,p=void 0,b=1/t[r];for(l=0;l<=r;l++)o[0].coef[l]=t[l]*b;var m=Math.abs(o[0].coef[0]),y=1;if(m>10)for(var x=y=Math.pow(m,-1/r),w=r-1;w>=0;w--)o[0].coef[w]*=x,x*=y;var g=function(t,r,e){var a=0,f=0,o=void 0,i=r[0].coef[r[0].ord],s=1;for(s=1;s<=t;s++)o=r[s].coef[r[s].ord],(0==i||i*o<0)&&a++,i=o;if(e)f=n(t,r,0);else{i=1&r[0].ord?-r[0].coef[r[0].ord]:r[0].coef[r[0].ord];for(var u=1;u<=t;u++)o=1&r[u].ord?-r[u].coef[r[u].ord]:r[u].coef[r[u].ord],(0==i||i*o<0)&&f++,i=o}return{nroots:f-a,atmin:f,atmax:a}}(p=function(t,r){r[0].ord=t,r[1].ord=t-1;var e=void 0,a=void 0,f=Math.abs(r[0].coef[t]*t),o=0;for(e=1;e<=t;e++)r[1].coef[o]=r[0].coef[o+1]*e/f,o++;var n=2;for(a=r[n];i(r[n-2],r[n-1],a);){for(f=-Math.abs(a.coef[a.ord]),o=a.ord;o>=0;o--)a.coef[o]/=f;a=r[++n]}return a.coef[0]=-a.coef[0],n}(r,o),o,f),M=g.nroots,k=g.atmin,z=g.atmax;if(0==M)return M;if(f)c=0;else{for(_=n(p,o,c=-1),l=0;_!=k&&l!=h;l++)_=n(p,o,c*=10);_!=k&&(k=_)}for(_=n(p,o,d=1),l=0;_!=z&&l!=h;l++)_=n(p,o,d*=10);for(_!=z&&(z=_),M=k-z,s(p,o,c,d,k,z,e,0),l=0;l<M;l++)e[l]/=y;return M}Object.defineProperty(r,"__esModule",{value:!0});var c=1e-12,h=32,d=800,l=1e-12,v=20;r.default=u},function(t,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function t(t,r){for(var e=0;e<r.length;e++){var a=r[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(r,e,a){return e&&t(r.prototype,e),a&&t(r,a),r}}(),f=function(){function t(r){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.arView=r,this.init()}return a(t,[{key:"init",value:function(){this.debugWindow=document.createElement("div"),this.debugWindow.id="debug-window",this.debugWindow.style.position="fixed",this.debugWindow.style.bottom="0px",this.debugWindow.style.left="0px",this.debugWindow.style.color="white",this.debugWindow.style.backgroundColor="transparent",this.debugWindow.style.whiteSpace="pre",this.debugWindow.style.padding="10px",document.body.append(this.debugWindow)}},{key:"update",value:function(){if(this.arView.pose)for(var t=0;t<this.arView.transform.data.length;t++)this.debugWindow.innerHTML="Rotation X: "+this.arView.pose.rotation.x+"\n",this.debugWindow.innerHTML+="Rotation Y: "+this.arView.pose.rotation.y+"\n",this.debugWindow.innerHTML+="Rotation Z: "+this.arView.pose.rotation.z+"\n",this.debugWindow.innerHTML+="Translation X: "+this.arView.pose.translation.x+"\n",this.debugWindow.innerHTML+="Translation Y: "+this.arView.pose.translation.y+"\n",this.debugWindow.innerHTML+="Translation Z: "+this.arView.pose.translation.z+"\n"}}]),t}();r.default=f}])});